/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/closure-library/LICENSE
 * 
 *  - the JSXCompressor library (http://jsxgraph.uni-bayreuth.de/wp/jsxcompressor/)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/JXG/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
function i(a){throw a;}var m=void 0,o=!0,q=null,r=!1;function aa(){return function(){}}function ba(a){return function(b){this[a]=b}}function s(a){return function(){return this[a]}}var t,ca=this;function da(){}
function fa(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ga(a){return a!==m}function y(a){return a!=q}function B(a){return"array"==fa(a)}function ha(a){var b=fa(a);return"array"==b||"object"==b&&"number"==typeof a.length}function ia(a){return"string"==typeof a}function D(a){return"number"==typeof a}function ja(a){return"function"==fa(a)}function ka(a){a=fa(a);return"object"==a||"array"==a||"function"==a}function la(a){return a[ma]||(a[ma]=++na)}
var ma="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),na=0;function oa(a,b,c){return a.call.apply(a.bind,arguments)}function pa(a,b,c){a||i(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function ra(a,b,c){ra=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?oa:pa;return ra.apply(q,arguments)}function sa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var ta=Date.now||function(){return+new Date};
function E(a,b){var c=a.split("."),d=ca;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&ga(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function G(a,b){function c(){}c.prototype=b.prototype;a.j=b.prototype;a.prototype=new c;a.prototype.constructor=a};function ua(a,b,c){this.Ba=this.Aa=this.za=0;3==arguments.length?(this.za=Number(a),this.Aa=Number(b),this.Ba=Number(c)):a instanceof ua?(this.za=Number(a.x()),this.Aa=Number(a.y()),this.Ba=Number(a.b())):(this.za=Number(a[0]),this.Aa=Number(a[1]),this.Ba=Number(a[2]))}
ua.prototype={f:function(){return new ua(this.za,this.Aa,this.Ba)},Ye:function(){return new ua(-this.za,-this.Aa,-this.Ba)},uc:function(a){return new ua(this.za+a.x(),this.Aa+a.y(),this.Ba+a.b())},cd:function(a){return new ua(this.za-a.x(),this.Aa-a.y(),this.Ba-a.b())},Fb:function(a){return new ua(this.za*a,this.Aa*a,this.Ba*a)},ph:function(a){return new ua(this.za/a,this.Aa/a,this.Ba/a)},rc:function(a){return this.za*a.x()+this.Aa*a.y()+this.Ba*a.b()},jg:function(a,b){return this.uc(a.cd(this).Fb(b))},
length:function(){return Math.sqrt(this.rc(this))},kd:function(){return this.ph(this.length())},Ie:function(a){return new ua(this.Aa*a.b()-this.Ba*a.y(),this.Ba*a.x()-this.za*a.b(),this.za*a.y()-this.Aa*a.x())},x:s("za"),y:s("Aa"),b:s("Ba")};var H=H||{};H.lj=o;H.Ia=function(a){eval("X.DEV === undefined")||window.console.time(a)};H.Ca=function(a){eval("X.DEV === undefined")||window.console.timeEnd(a)};window["X.counter"]=new function(){this.Wg=0;this.hj=function(){return this.Wg++}};function va(a,b){for(var c in b){var d=b.__lookupGetter__(c),e=b.__lookupSetter__(c);d||e?(d&&a.__defineGetter__(c,d),e&&a.__defineSetter__(c,e)):a[c]=b[c]}}var xa=window.Og;
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,e.concat(d.call(arguments)))}function c(){}"function"!==typeof this&&i(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var d=Array.prototype.slice,e=d.call(arguments,1),f=this;c.prototype=this.prototype;b.prototype=new c;return b});
(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.fd;++c)window.fd=window[b[c]+"RequestAnimationFrame"],window.Id=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.fd||(window.fd=function(b){var c=Date.now(),f=Math.max(0,16-(c-a)),g=window.setTimeout(function(){b(c+f)},f);a=c+f;return g});window.Id||(window.Id=function(a){clearTimeout(a)})})();
"slice"in ArrayBuffer.prototype||(ArrayBuffer.prototype.slice=function(a,b){a===m&&i(Error("Not enough arguments."));var c=b||this.byteLength;0>a&&(a=this.byteLength+a);0>c&&(c=this.byteLength+c);c<a&&(c=a=0);0>a&&(a=0);0>c&&(c=0);a>this.byteLength&&(a=this.byteLength);c>this.byteLength&&(c=this.byteLength);for(var d=new ArrayBuffer(c-a),e=new Uint8Array(this),f=new Uint8Array(d),g=a,h=0;g<c;++g,++h)f[h]=e[g];return d});E("$",xa);E("Function.prototype.bind",Function.prototype.bind);
E("window.requestAnimationFrame",window.fd);E("window.cancelAnimationFrame",window.Id);function ya(a){if(!za.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Aa,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Ba,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Ca,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Fa,"&quot;"));return a}var Aa=/&/g,Ba=/</g,Ca=/>/g,Fa=/\"/g,za=/[&<>\"]/;var Ga,Ha,Ia,Ja,La,Ma,Na;function Oa(){return ca.navigator?ca.navigator.userAgent:q}function Pa(){return ca.navigator}La=Ja=Ia=Ha=Ga=r;var Qa;if(Qa=Oa()){var Ra=Pa();Ga=0==Qa.indexOf("Opera");Ha=!Ga&&-1!=Qa.indexOf("MSIE");Ja=(Ia=!Ga&&-1!=Qa.indexOf("WebKit"))&&-1!=Qa.indexOf("Mobile");La=!Ga&&!Ia&&"Gecko"==Ra.product}var Sa=Ga,Ua=Ha,Va=La,Wa=Ia,Xa=Ja,Ya,Za=Pa();Ya=Za&&Za.platform||"";Ma=-1!=Ya.indexOf("Mac");Na=-1!=Ya.indexOf("Win");var $a=!!Pa()&&-1!=(Pa().appVersion||"").indexOf("X11"),ab;
a:{var cb="",db;if(Sa&&ca.opera)var eb=ca.opera.version,cb="function"==typeof eb?eb():eb;else if(Va?db=/rv\:([^\);]+)(\)|;)/:Ua?db=/MSIE\s+([^\);]+)(\)|;)/:Wa&&(db=/WebKit\/(\S+)/),db)var fb=db.exec(Oa()),cb=fb?fb[1]:"";if(Ua){var gb,hb=ca.document;gb=hb?hb.documentMode:m;if(gb>parseFloat(cb)){ab=""+gb;break a}}ab=cb}var jb={};
function kb(a){var b;if(!(b=jb[a])){b=0;for(var c=(""+ab).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=(""+a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",j=RegExp("(\\d*)(\\D*)","g"),l=RegExp("(\\d*)(\\D*)","g");do{var k=j.exec(g)||["","",""],n=l.exec(h)||["","",""];if(0==k[0].length&&0==n[0].length)break;b=((0==k[1].length?0:parseInt(k[1],10))<(0==n[1].length?0:parseInt(n[1],10))?-1:(0==k[1].length?0:parseInt(k[1],
10))>(0==n[1].length?0:parseInt(n[1],10))?1:0)||((0==k[2].length)<(0==n[2].length)?-1:(0==k[2].length)>(0==n[2].length)?1:0)||(k[2]<n[2]?-1:k[2]>n[2]?1:0)}while(0==b)}b=jb[a]=0<=b}return b}var lb={};function mb(a){return lb[a]||(lb[a]=Ua&&document.documentMode&&document.documentMode>=a)};function nb(a,b){for(var c in a)b.call(m,a[c],c,a)}function ob(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function pb(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}var qb="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");function rb(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<qb.length;f++)c=qb[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var ub=Array.prototype,vb=ub.indexOf?function(a,b,c){return ub.indexOf.call(a,b,c)}:function(a,b,c){c=c==q?0:0>c?Math.max(0,a.length+c):c;if(ia(a))return!ia(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},wb=ub.forEach?function(a,b,c){ub.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ia(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},xb=ub.map?function(a,b,c){return ub.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=
ia(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},yb=ub.some?function(a,b,c){return ub.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ia(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return o;return r},zb=ub.every?function(a,b,c){return ub.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ia(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return r;return o};function Ab(a,b){var c=vb(a,b);0<=c&&ub.splice.call(a,c,1)}
function Bb(a){return ub.concat.apply(ub,arguments)}function Cb(a){if(B(a))return Bb(a);for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}function Db(a,b,c){return 2>=arguments.length?ub.slice.call(a,b):ub.slice.call(a,b,c)};function Eb(a){if("function"==typeof a.Za)a=a.Za();else if(ha(a)||ia(a))a=a.length;else{var b=0,c;for(c in a)b++;a=b}return a}function Fb(a){if("function"==typeof a.Pa)return a.Pa();if(ia(a))return a.split("");if(ha(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return ob(a)}
function Gb(a,b){if("function"==typeof a.every)return a.every(b,m);if(ha(a)||ia(a))return zb(a,b,m);var c;if("function"==typeof a.Zc)c=a.Zc();else if("function"!=typeof a.Pa)if(ha(a)||ia(a)){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else c=pb(a);else c=m;for(var d=Fb(a),e=d.length,f=0;f<e;f++)if(!b.call(m,d[f],c&&c[f],a))return r;return o};var Hb="StopIteration"in ca?ca.StopIteration:Error("StopIteration");function Ib(){}Ib.prototype.next=function(){i(Hb)};Ib.prototype.Ac=function(){return this};function Mb(a){if(a instanceof Ib)return a;if("function"==typeof a.Ac)return a.Ac(r);if(ha(a)){var b=0,c=new Ib;c.next=function(){for(;;){b>=a.length&&i(Hb);if(b in a)return a[b++];b++}};return c}i(Error("Not implemented"))}
function Nb(a,b){if(ha(a))try{wb(a,b,m)}catch(c){c!==Hb&&i(c)}else{a=Mb(a);try{for(;;)b.call(m,a.next(),m,a)}catch(d){d!==Hb&&i(d)}}};function Ob(a,b){this.D={};this.v=[];var c=arguments.length;if(1<c){c%2&&i(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.Be(a)}t=Ob.prototype;t.N=0;t.ld=0;t.Za=s("N");t.Pa=function(){Pb(this);for(var a=[],b=0;b<this.v.length;b++)a.push(this.D[this.v[b]]);return a};t.Zc=function(){Pb(this);return this.v.concat()};t.Ge=function(a){for(var b=0;b<this.v.length;b++){var c=this.v[b];if(Qb(this.D,c)&&this.D[c]==a)return o}return r};
t.Vc=function(a,b){if(this===a)return o;if(this.N!=a.Za())return r;var c=b||Rb;Pb(this);for(var d,e=0;d=this.v[e];e++)if(!c(this.get(d),a.get(d)))return r;return o};function Rb(a,b){return a===b}t.clear=function(){this.D={};this.ld=this.N=this.v.length=0};t.remove=function(a){return Qb(this.D,a)?(delete this.D[a],this.N--,this.ld++,this.v.length>2*this.N&&Pb(this),o):r};
function Pb(a){if(a.N!=a.v.length){for(var b=0,c=0;b<a.v.length;){var d=a.v[b];Qb(a.D,d)&&(a.v[c++]=d);b++}a.v.length=c}if(a.N!=a.v.length){for(var e={},c=b=0;b<a.v.length;)d=a.v[b],Qb(e,d)||(a.v[c++]=d,e[d]=1),b++;a.v.length=c}}t.get=function(a,b){return Qb(this.D,a)?this.D[a]:b};t.set=function(a,b){Qb(this.D,a)||(this.N++,this.v.push(a),this.ld++);this.D[a]=b};t.Be=function(a){var b;a instanceof Ob?(b=a.Zc(),a=a.Pa()):(b=pb(a),a=ob(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])};t.f=function(){return new Ob(this)};
t.Ac=function(a){Pb(this);var b=0,c=this.v,d=this.D,e=this.ld,f=this,g=new Ib;g.next=function(){for(;;){e!=f.ld&&i(Error("The map has changed since the iterator was created"));b>=c.length&&i(Hb);var g=c[b++];return a?g:d[g]}};return g};function Qb(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Sb(a){this.D=new Ob;a&&this.Be(a)}function Tb(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+la(a):b.substr(0,1)+a}t=Sb.prototype;t.Za=function(){return this.D.Za()};t.add=function(a){this.D.set(Tb(a),a)};t.Be=function(a){for(var a=Fb(a),b=a.length,c=0;c<b;c++)this.add(a[c])};t.Zd=function(a){for(var a=Fb(a),b=a.length,c=0;c<b;c++)this.remove(a[c])};t.remove=function(a){return this.D.remove(Tb(a))};t.clear=function(){this.D.clear()};
t.contains=function(a){a=Tb(a);return Qb(this.D.D,a)};t.fg=function(a){for(var b=new Sb,a=Fb(a),c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};t.Pa=function(){return this.D.Pa()};t.f=function(){return new Sb(this)};t.Vc=function(a){return this.Za()==Eb(a)&&Ub(this,a)};
function Ub(a,b){var c=Eb(b);if(a.Za()>c)return r;!(b instanceof Sb)&&5<c&&(b=new Sb(b));return Gb(a,function(a){if("function"==typeof b.contains)a=b.contains(a);else if("function"==typeof b.Ge)a=b.Ge(a);else if(ha(b)||ia(b))a=0<=vb(b,a);else a:{for(var c in b)if(b[c]==a){a=o;break a}a=r}return a})}t.Ac=function(){return this.D.Ac(r)};function Vb(){}Vb.prototype.Uf=r;Vb.prototype.Oa=function(){this.Uf||(this.Uf=o,this.O())};Vb.prototype.O=function(){this.mh&&Wb.apply(q,this.mh)};function Xb(a){a&&"function"==typeof a.Oa&&a.Oa()}function Wb(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];ha(d)?Wb.apply(q,d):Xb(d)}};function Yb(a,b){this.lg=b;this.Yc=[];a>this.lg&&i(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.Yc.push(this.Kd())}G(Yb,Vb);t=Yb.prototype;t.Rf=q;t.Tf=q;function Zb(a,b){a.Yc.length<a.lg?a.Yc.push(b):a.Le(b)}t.Kd=function(){return this.Rf?this.Rf():{}};t.Le=function(a){if(this.Tf)this.Tf(a);else if(ka(a))if(ja(a.Oa))a.Oa();else for(var b in a)delete a[b]};t.O=function(){Yb.j.O.call(this);for(var a=this.Yc;a.length;)this.Le(a.pop());delete this.Yc};function $b(){this.Wc=[];this.df=new Ob;this.Hg=this.Ig=this.Jg=this.Eg=0;this.jd=new Ob;this.Of=this.Gg=0;this.Ze=1;this.Me=new Yb(0,4E3);this.Me.Kd=function(){return new ac};this.Fg=new Yb(0,50);this.Fg.Kd=function(){return new bc};var a=this;this.Pe=new Yb(0,2E3);this.Pe.Kd=function(){return""+a.Ze++};this.Pe.Le=aa()}function bc(){this.rf=this.time=this.count=0}
bc.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");this.rf&&a.push(" [VarAlloc = ",this.rf,"]");return a.join("")};function ac(){}function cc(a,b,c,d){var e=[];-1==c?e.push("    "):e.push(dc(a.Vf-c));e.push(" ",ec(a.Vf-b));0==a.Ne?e.push(" Start        "):1==a.Ne?(e.push(" Done "),e.push(dc(a.dk-a.startTime)," ms ")):e.push(" Comment      ");e.push(d,a);0<a.dj&&e.push("[VarAlloc ",a.dj,"] ");return e.join("")}
ac.prototype.toString=function(){return this.type==q?this.jh:"["+this.type+"] "+this.jh};$b.prototype.reset=function(){for(var a=0;a<this.Wc.length;a++){var b=this.Me.id;b&&Zb(this.Pe,b);Zb(this.Me,this.Wc[a])}this.Wc.length=0;this.df.clear();this.Eg=ta();this.Of=this.Gg=this.Hg=this.Ig=this.Jg=0;b=this.jd.Zc();for(a=0;a<b.length;a++){var c=this.jd.get(b[a]);c.count=0;c.time=0;c.rf=0;Zb(this.Fg,c)}this.jd.clear()};
$b.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.Wc.length;d++){var e=this.Wc[d];1==e.Ne&&c.pop();a.push(" ",cc(e,this.Eg,b,c.join("")));b=e.Vf;a.push("\n");0==e.Ne&&c.push("|  ")}if(0!=this.df.Za()){var f=ta();a.push(" Unstopped timers:\n");Nb(this.df,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",ec(b.startTime),")\n")})}b=this.jd.Zc();for(d=0;d<b.length;d++)c=this.jd.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",this.Gg,"\n","Total comments created ",
this.Of,"\n","Overhead start: ",this.Jg," ms\n","Overhead end: ",this.Ig," ms\n","Overhead comment: ",this.Hg," ms\n");return a.join("")};function dc(a){var a=Math.round(a),b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function ec(a){a=Math.round(a);return(""+(100+a/1E3%60)).substring(1,3)+"."+(""+(1E3+a%1E3)).substring(1,4)}new $b;function fc(){}var gc=0;t=fc.prototype;t.key=0;t.wc=r;t.De=r;t.ha=function(a,b,c,d,e,f){ja(a)?this.gg=o:a&&a.handleEvent&&ja(a.handleEvent)?this.gg=r:i(Error("Invalid listener argument"));this.ad=a;this.Ag=b;this.src=c;this.type=d;this.capture=!!e;this.Oe=f;this.De=r;this.key=++gc;this.wc=r};t.handleEvent=function(a){return this.gg?this.ad.call(this.Oe||this.src,a):this.ad.handleEvent.call(this.ad,a)};!Ua||mb(9);var hc=!Ua||mb(9),ic=Ua&&!kb("8");!Wa||kb("528");Va&&kb("1.9b")||Ua&&kb("8")||Sa&&kb("9.5")||Wa&&kb("528");!Va||kb("8");function jc(a,b){this.type=a;this.currentTarget=this.target=b}G(jc,Vb);t=jc.prototype;t.O=function(){delete this.type;delete this.target;delete this.currentTarget};t.dc=r;t.gd=o;t.stopPropagation=function(){this.dc=o};t.preventDefault=function(){this.gd=r};function kc(a){kc[" "](a);return a}kc[" "]=da;function lc(a,b){a&&this.ha(a,b)}G(lc,jc);t=lc.prototype;t.target=q;t.relatedTarget=q;t.offsetX=0;t.offsetY=0;t.clientX=0;t.clientY=0;t.screenX=0;t.screenY=0;t.button=0;t.keyCode=0;t.charCode=0;t.ctrlKey=r;t.altKey=r;t.shiftKey=r;t.metaKey=r;t.Ea=q;
t.ha=function(a,b){var c=this.type=a.type;jc.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Va){var e;a:{try{kc(d.nodeName);e=o;break a}catch(f){}e=r}e||(d=q)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=Wa||a.offsetX!==m?a.offsetX:a.layerX;this.offsetY=Wa||a.offsetY!==m?a.offsetY:a.layerY;this.clientX=a.clientX!==m?a.clientX:a.pageX;this.clientY=a.clientY!==m?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;this.Ea=a;delete this.gd;delete this.dc};t.stopPropagation=function(){lc.j.stopPropagation.call(this);this.Ea.stopPropagation?this.Ea.stopPropagation():this.Ea.cancelBubble=o};
t.preventDefault=function(){lc.j.preventDefault.call(this);var a=this.Ea;if(a.preventDefault)a.preventDefault();else if(a.returnValue=r,ic)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};t.yh=s("Ea");t.O=function(){lc.j.O.call(this);this.relatedTarget=this.currentTarget=this.target=this.Ea=q};var mc={},nc={},oc={},pc={};
function J(a,b,c,d,e){if(b){if(B(b)){for(var f=0;f<b.length;f++)J(a,b[f],c,d,e);return q}var d=!!d,g=nc;b in g||(g[b]={N:0,Ga:0});g=g[b];d in g||(g[d]={N:0,Ga:0},g.N++);var g=g[d],h=la(a),j;g.Ga++;if(g[h]){j=g[h];for(f=0;f<j.length;f++)if(g=j[f],g.ad==c&&g.Oe==e){if(g.wc)break;return j[f].key}}else j=g[h]=[],g.N++;f=qc();f.src=a;g=new fc;g.ha(c,f,a,b,d,e);c=g.key;f.key=c;j.push(g);mc[c]=g;oc[h]||(oc[h]=[]);oc[h].push(g);a.addEventListener?(a==ca||!a.Sf)&&a.addEventListener(b,f,d):a.attachEvent(b in
pc?pc[b]:pc[b]="on"+b,f);return c}i(Error("Invalid event type"))}function qc(){var a=rc,b=hc?function(c){return a.call(b.src,b.key,c)}:function(c){c=a.call(b.src,b.key,c);if(!c)return c};return b}function sc(a,b,c,d,e){if(B(b))for(var f=0;f<b.length;f++)sc(a,b[f],c,d,e);else a=J(a,b,c,d,e),mc[a].De=o}
function tc(a,b,c,d,e){if(B(b))for(var f=0;f<b.length;f++)tc(a,b[f],c,d,e);else{d=!!d;a:{f=nc;if(b in f&&(f=f[b],d in f&&(f=f[d],a=la(a),f[a]))){a=f[a];break a}a=q}if(a)for(f=0;f<a.length;f++)if(a[f].ad==c&&a[f].capture==d&&a[f].Oe==e){uc(a[f].key);break}}}
function uc(a){if(!mc[a])return r;var b=mc[a];if(b.wc)return r;var c=b.src,d=b.type,e=b.Ag,f=b.capture;c.removeEventListener?(c==ca||!c.Sf)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in pc?pc[d]:pc[d]="on"+d,e);c=la(c);e=nc[d][f][c];if(oc[c]){var g=oc[c];Ab(g,b);0==g.length&&delete oc[c]}b.wc=o;e.pg=o;vc(d,f,c,e);delete mc[a];return o}
function vc(a,b,c,d){if(!d.Vd&&d.pg){for(var e=0,f=0;e<d.length;e++)d[e].wc?d[e].Ag.src=q:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.pg=r;0==f&&(delete nc[a][b][c],nc[a][b].N--,0==nc[a][b].N&&(delete nc[a][b],nc[a].N--),0==nc[a].N&&delete nc[a])}}function wc(a){var b,c=0,d=b==q;b=!!b;if(a==q)nb(oc,function(a){for(var e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)uc(f.key),c++}});else if(a=la(a),oc[a])for(var a=oc[a],e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)uc(f.key),c++}}
function xc(a){var b=yc,a=la(a),c=oc[a];if(c){var d=ga(b),e=ga(m);return d&&e?(c=nc[b],!!c&&!!c[m]&&a in c[m]):!d&&!e?o:yb(c,function(a){return d&&a.type==b||e&&a.capture==m})}return r}function zc(a,b,c,d,e){var f=1,b=la(b);if(a[b]){a.Ga--;a=a[b];a.Vd?a.Vd++:a.Vd=1;try{for(var g=a.length,h=0;h<g;h++){var j=a[h];j&&!j.wc&&(f&=Ac(j,e)!==r)}}finally{a.Vd--,vc(c,d,b,a)}}return Boolean(f)}function Ac(a,b){var c=a.handleEvent(b);a.De&&uc(a.key);return c}
function rc(a,b){if(!mc[a])return o;var c=mc[a],d=c.type,e=nc;if(!(d in e))return o;var e=e[d],f,g;if(!hc){var h;if(!(h=b))a:{h=["window","event"];for(var j=ca;f=h.shift();)if(y(j[f]))j=j[f];else{h=q;break a}h=j}f=h;h=o in e;j=r in e;if(h){if(0>f.keyCode||f.returnValue!=m)return o;a:{var l=r;if(0==f.keyCode)try{f.keyCode=-1;break a}catch(k){l=o}if(l||f.returnValue==m)f.returnValue=o}}l=new lc;l.ha(f,this);f=o;try{if(h){for(var n=[],v=l.currentTarget;v;v=v.parentNode)n.push(v);g=e[o];g.Ga=g.N;for(var p=
n.length-1;!l.dc&&0<=p&&g.Ga;p--)l.currentTarget=n[p],f&=zc(g,n[p],d,o,l);if(j){g=e[r];g.Ga=g.N;for(p=0;!l.dc&&p<n.length&&g.Ga;p++)l.currentTarget=n[p],f&=zc(g,n[p],d,r,l)}}else f=Ac(c,l)}finally{n&&(n.length=0),l.Oa()}return f}d=new lc(b,this);try{f=Ac(c,d)}finally{d.Oa()}return f}var Bc=0;function Cc(a){return a+"_"+Bc++};function Dc(){}G(Dc,Vb);t=Dc.prototype;t.Sf=o;t.Xd=q;t.gf=ba("Xd");t.addEventListener=function(a,b,c,d){J(this,a,b,c,d)};t.removeEventListener=function(a,b,c,d){tc(this,a,b,c,d)};
t.dispatchEvent=function(a){var b=a.type||a,c=nc;if(b in c){if(ia(a))a=new jc(a,this);else if(a instanceof jc)a.target=a.target||this;else{var d=a,a=new jc(b,this);rb(a,d)}var d=1,e,c=c[b],b=o in c,f;if(b){e=[];for(f=this;f;f=f.Xd)e.push(f);f=c[o];f.Ga=f.N;for(var g=e.length-1;!a.dc&&0<=g&&f.Ga;g--)a.currentTarget=e[g],d&=zc(f,e[g],a.type,o,a)&&a.gd!=r}if(r in c)if(f=c[r],f.Ga=f.N,b)for(g=0;!a.dc&&g<e.length&&f.Ga;g++)a.currentTarget=e[g],d&=zc(f,e[g],a.type,r,a)&&a.gd!=r;else for(e=this;!a.dc&&e&&
f.Ga;e=e.Xd)a.currentTarget=e,d&=zc(f,e,a.type,r,a)&&a.gd!=r;a=Boolean(d)}else a=o;return a};t.O=function(){Dc.j.O.call(this);wc(this);this.Xd=q};function K(){this.c="base";this.ra=window["X.counter"].hj();this.e=r}G(K,Dc);K.prototype.__defineGetter__("classname",s("c"));K.prototype.__defineGetter__("id",s("ra"));E("X.base",K);function Ec(a,b){this.ya=new ua(a);this.ea=new ua(b)}Ec.prototype={f:function(){return new Ec(this.ya.f(),this.ea.f())},ac:function(){this.ea=this.ea.Ye()},Mh:function(a,b){return new Ec(this.ya.jg(a.ya,b),this.ea.jg(a.ea,b))}};function Ic(a,b){this.ea=a;this.md=b}Ic.prototype={f:function(){return new Ic(this.ea.f(),this.md)},ac:function(){this.ea=this.ea.Ye();this.md=-this.md}};function Jc(a,b){this.kb=a;this.ce=b;var c=a[0].ya,d=a[2].ya,d=a[1].ya.cd(c).Ie(d.cd(c)).kd();this.xa=new Ic(d,d.rc(c))}
Jc.prototype={f:function(){var a=this.kb.map(function(a){return a.f()});return new Jc(a,this.ce)},ac:function(){this.kb.reverse().map(function(a){a.ac()});this.xa.ac()},Dg:function(a,b,c,d,e){for(var f=0,g=[],h=0;h<this.kb.length;h++){var j=a.ea.rc(this.kb[h].ya)-a.md,j=-1.0E-5>j?2:1.0E-5<j?1:0,f=f|j;g.push(j)}switch(f){case 0:(0<a.ea.rc(this.xa.ea)?b:c).push(this);break;case 1:d.push(this);break;case 2:e.push(this);break;case 3:b=[];c=[];for(h=0;h<this.kb.length;h++){var l=(h+1)%this.kb.length,j=
g[h],k=g[l],f=this.kb[h],l=this.kb[l];2!=j&&b.push(f);1!=j&&c.push(2!=j?f.f():f);3==(j|k)&&(j=(a.md-a.ea.rc(f.ya))/a.ea.rc(l.ya.cd(f.ya)),j=f.Mh(l,j),b.push(j),c.push(j.f()))}3<=b.length&&d.push(new Jc(b,this.ce));3<=c.length&&e.push(new Jc(c,this.ce))}}};function Kc(a){this.fa=this.ga=this.xa=q;this.z=[];a&&this.nc(a)}
Kc.prototype={f:function(){var a=new Kc;a.Oi(this.xa&&this.xa.f());a.Ni(this.ga&&this.ga.f());a.Mi(this.fa&&this.fa.f());a.ae(this.z.map(function(a){return a.f()}));return a},$:function(){for(var a=0;a<this.z.length;a++)this.z[a].ac();this.xa.ac();this.ga&&this.ga.$();this.fa&&this.fa.$();a=this.ga;this.ga=this.fa;this.fa=a},Fe:function(a){if(!this.xa)return a.slice();for(var b=[],c=[],d=0;d<a.length;d++)a[d].Dg(this.xa,b,c,b,c);this.ga&&(b=this.ga.Fe(b));c=this.fa?this.fa.Fe(c):[];return b.concat(c)},
Na:function(a){this.z=a.Fe(this.z);this.ga&&this.ga.Na(a);this.fa&&this.fa.Na(a)},Db:function(){var a=this.z.slice();this.ga&&(a=a.concat(this.ga.Db()));this.fa&&(a=a.concat(this.fa.Db()));return a},nc:function(a){if(a.length){this.xa||(this.xa=a[0].xa.f());for(var b=[],c=[],d=0;d<a.length;d++)a[d].Dg(this.xa,this.z,this.z,b,c);b.length&&(this.ga||(this.ga=new Kc),this.ga.nc(b));c.length&&(this.fa||(this.fa=new Kc),this.fa.nc(c))}},Oi:ba("xa"),Ni:ba("ga"),Mi:ba("fa"),ae:ba("z")};function Lc(){this.z=[]}function Mc(a){var b=new Lc;b.ae(a);return b}
Lc.prototype={f:function(){var a=new Lc;a.ae(this.z.map(function(a){return a.f()}));return a},of:function(a){var b=new Kc(this.f().z),a=new Kc(a.f().z);b.Na(a);a.Na(b);a.$();a.Na(b);a.$();b.nc(a.Db());return Mc(b.Db())},Ta:function(a){var b=new Kc(this.f().z),a=new Kc(a.f().z);b.$();b.Na(a);a.Na(b);a.$();a.Na(b);a.$();b.nc(a.Db());b.$();return Mc(b.Db())},Re:function(a){var b=new Kc(this.f().z),a=new Kc(a.f().z);b.$();a.Na(b);a.$();b.Na(a);a.Na(b);b.nc(a.Db());b.$();return Mc(b.Db())},inverse:function(){var a=
this.f();a.z.map(function(a){a.ac()});return a},ae:ba("z")};function Nc(){K.call(this);this.c="indexer";this.ze=[];this.sb={}}G(Nc,K);Nc.prototype.add=function(a){y(a)||i(Error("Invalid object."));var b=window.JSON.stringify(a);b in this.sb||(this.sb[b]=this.ze.length,this.ze.push(a));return this.sb[b]};Nc.prototype.unique=s("ze");function Oc(a){K.call(this);this.c="file";this.wd=a;this.e=o}G(Oc,K);function Pc(){this.Jb=this.p=q}Pc.prototype.__defineSetter__("file",function(a){this.p=!y(a)||B(a)&&0==a.length?q:B(a)?1==a.length?new Oc(a[0]):xb(a,function(a){var c=new L;c.p=new Oc(a);return c}):new Oc(a)});Pc.prototype.__defineGetter__("file",function(){return!this.p?"":B(this.p)?this.p.map(function(a){return a.p.wd}):this.p.wd});Pc.prototype.__defineGetter__("filedata",s("Jb"));
Pc.prototype.__defineSetter__("filedata",function(a){if(!y(a)||B(a)&&0==a.length)this.Jb=q;if(B(a))if(1==a.length)this.Jb=a[0];else{var b=this.p.length,c;for(c=0;c<b;c++)this.p[c].Jb=a[c]}else this.Jb=a});function Qc(){K.call(this);this.c="colortable";this.sb=new Ob;va(this,new Pc)}G(Qc,K);Qc.prototype.add=function(a,b,c,d,e,f){(!D(a)||!D(c)||!D(d)||!D(e)||!D(f))&&i(Error("Invalid color table entry."));this.sb.set(a,[b,c,d,e,f]);this.e=o};function Rc(a,b,c){this.x=ga(a)?a:0;this.y=ga(b)?b:0;this.b=ga(c)?c:0}Rc.prototype.f=function(){return new Rc(this.x,this.y,this.b)};Rc.prototype.nf=function(){return[this.x,this.y,this.b]};function M(a,b,c){this.x=a;this.y=b;this.b=c}G(M,Rc);t=M.prototype;t.f=function(){return new M(this.x,this.y,this.b)};t.cc=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.b*this.b)};t.scale=function(a){this.x*=a;this.y*=a;this.b*=a;return this};t.$=function(){this.x=-this.x;this.y=-this.y;this.b=-this.b;return this};t.normalize=function(){return this.scale(1/this.cc())};t.add=function(a){this.x+=a.x;this.y+=a.y;this.b+=a.b;return this};
t.Ta=function(a){this.x-=a.x;this.y-=a.y;this.b-=a.b;return this};t.Vc=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y&&this.b==a.b};function Sc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.b-b.b;return Math.sqrt(c*c+d*d+e*e)}function Tc(a,b){return new M(a.x+b.x,a.y+b.y,a.b+b.b)}function Uc(a,b){return new M(a.y*b.b-a.b*b.y,a.b*b.x-a.x*b.b,a.x*b.y-a.y*b.x)};function Vc(a,b){this.x=ga(a)?a:0;this.y=ga(b)?b:0}Vc.prototype.f=function(){return new Vc(this.x,this.y)};function Wc(a,b){return new Vc(a.x-b.x,a.y-b.y)};function Xc(a,b){this.x=a;this.y=b}G(Xc,Vc);t=Xc.prototype;t.f=function(){return new Xc(this.x,this.y)};t.cc=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};t.scale=function(a){this.x*=a;this.y*=a;return this};t.$=function(){this.x=-this.x;this.y=-this.y;return this};t.normalize=function(){return this.scale(1/this.cc())};t.add=function(a){this.x+=a.x;this.y+=a.y;return this};t.Ta=function(a){this.x-=a.x;this.y-=a.y;return this};
t.rotate=function(a){var b=Math.cos(a),a=Math.sin(a),c=this.y*b+this.x*a;this.x=this.x*b-this.y*a;this.y=c;return this};t.Vc=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y};function Yc(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d};function Zc(a,b){this.width=a;this.height=b}function $c(a,b){return a==b?o:!a||!b?r:a.width==b.width&&a.height==b.height}Zc.prototype.f=function(){return new Zc(this.width,this.height)};Zc.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};Zc.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};Zc.prototype.scale=function(a){this.width*=a;this.height*=a;return this};function ad(a,b){if(a instanceof ad)this.W=a.nf();else{var c;if(c=ha(a))a:{for(var d=c=0;d<a.length;d++){if(!ha(a[d])||0<c&&a[d].length!=c){c=r;break a}for(var e=0;e<a[d].length;e++)if(!D(a[d][e])){c=r;break a}0==c&&(c=a[d].length)}c=0!=c}c?this.W=Cb(a):a instanceof Zc?this.W=bd(a.height,a.width):D(a)&&D(b)&&0<a&&0<b?this.W=bd(a,b):i(Error("Invalid argument(s) for Matrix contructor"))}this.F=new Zc(this.W[0].length,this.W.length)}
function cd(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new ad(b)}function dd(a,b,c){for(var d=0;d<a.wa().height;d++)for(var e=0;e<a.wa().width;e++)b.call(c,a.W[d][e],d,e,a)}function ed(a,b){var c=new ad(a.wa());dd(a,function(d,e,f){c.W[e][f]=b.call(m,d,e,f,a)});return c}function bd(a,b){for(var c=[],d=0;d<a;d++){c[d]=[];for(var e=0;e<b;e++)c[d][e]=0}return c}t=ad.prototype;
t.add=function(a){$c(this.F,a.wa())||i(Error("Matrix summation is only supported on arrays of equal size"));return ed(this,function(b,c,d){return b+a.W[c][d]})};t.Vc=function(a,b){if(this.F.width!=a.F.width||this.F.height!=a.F.height)return r;for(var c=b||0,d=0;d<this.F.height;d++)for(var e=0;e<this.F.width;e++)if(!(Math.abs(this.W[d][e]-a.W[d][e])<=(c||1.0E-6)))return r;return o};t.wa=s("F");t.X=function(a,b){return!(0<=a&&a<this.F.height&&0<=b&&b<this.F.width)?q:this.W[a][b]};
t.k=function(a,b,c){0<=a&&a<this.F.height&&0<=b&&b<this.F.width||i(Error("Index out of bounds when setting matrix value, ("+a+","+b+") in size ("+this.F.height+","+this.F.width+")"));this.W[a][b]=c};t.multiply=function(a){if(a instanceof ad)return this.F.width!=a.wa().height&&i(Error("Invalid matrices for multiplication. Second matrix should have the same number of rows as the first has columns.")),gd(this,a);if(D(a))return hd(this,a);i(Error("A matrix can only be multiplied by a number or another matrix."))};
t.Ta=function(a){$c(this.F,a.wa())||i(Error("Matrix subtraction is only supported on arrays of equal size."));return ed(this,function(b,c,d){return b-a.W[c][d]})};t.nf=s("W");function gd(a,b){var c=new ad(a.F.height,b.wa().width);dd(c,function(a,e,f){for(var g=a=0;g<this.F.width;g++)a+=this.X(e,g)*b.X(g,f);c.k(e,f,a)},a);return c}function hd(a,b){return ed(a,function(a){return a*b})};function id(a,b){ad.call(this,a,b);this.c="matrix"}G(id,ad);function jd(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new id(b)}t=id.prototype;t.Fa=function(){var a=[],b=this.wa(),c,d;for(d=0;d<b.height;d++)for(c=0;c<b.width;c++)a.push(this.X(c,d));return a};
t.translate=function(a){this.F.width!=this.F.height&&i(Error("Can not translate non-square matrix."));var b=this.wa(),c=cd(b.height);a instanceof Xc&&3==b.height?(c.k(0,2,a.x),c.k(1,2,a.y)):a instanceof M&&4==b.height?(c.k(0,3,a.x),c.k(1,3,a.y),c.k(2,3,a.b)):i(Error("Translation failed."));return new id(this.multiply(c))};
t.rotate=function(a,b){(4!=this.wa().height||this.F.width!=this.F.height)&&i(Error("Only 4x4 matrices can be rotated."));(!y(b)||!(b instanceof M))&&i(Error("Invalid axis vector."));D(a)||i(Error("Invalid angle."));var c=b.normalize(),d=Math.cos(a),e=Math.sin(a),f=cd(4);f.k(0,0,d+c.x*c.x*(1-d));f.k(0,1,c.x*c.y*(1-d)-c.b*e);f.k(0,2,c.x*c.b*(1-d)+c.y*e);f.k(1,0,c.y*c.x*(1-d)+c.b*e);f.k(1,1,d+c.y*c.y*(1-d));f.k(1,2,c.y*c.b*(1-d)-c.x*e);f.k(2,0,c.b*c.x*(1-d)-c.y*e);f.k(2,1,c.b*c.y*(1-d)+c.x*e);f.k(2,
2,d+c.b*c.b*(1-d));return new id(this.multiply(f))};t.Ra=function(a){var b=this.wa(),c=Array(b.width),d;for(d=0;d<c.length;d++)c[d]=Array(1),c[d][0]=1;a instanceof M&&3<=b.width?(c[0][0]=a.x,c[1][0]=a.y,c[2][0]=a.b):i(Error("Multiplication by vector failed."));a=this.multiply(new ad(c));return new M(parseFloat(a.X(0,0)),parseFloat(a.X(1,0)),parseFloat(a.X(2,0)))};t.bj=function(a,b){var c=this.W[a];this.W[a]=this.W[b];this.W[b]=c};
t.aj=function(a,b){for(var c=this.wa(),d=0,d=0;d<c.height;d++){var e=this.X(d,a);e||(e=0);var f=this.X(d,b);f||(f=0);this.k(d,a,f);this.k(d,b,e)}};E("X.matrix",id);E("X.matrix.createIdentityMatrix",jd);E("X.matrix.prototype.flatten",id.prototype.Fa);E("X.matrix.prototype.translate",id.prototype.translate);E("X.matrix.prototype.rotate",id.prototype.rotate);E("X.matrix.prototype.toArray",id.prototype.nf);E("X.matrix.prototype.getValueAt",id.prototype.X);E("X.matrix.prototype.setValueAt",id.prototype.k);
E("X.matrix.prototype.multiplyByVector",id.prototype.Ra);E("X.matrix.prototype.swapRows",id.prototype.bj);E("X.matrix.prototype.swapCols",id.prototype.aj);function kd(){K.call(this);this.c="transform";this.C=jd(4);this.yf=new Float32Array(this.C.Fa())}G(kd,K);kd.prototype.__defineGetter__("matrix",s("C"));kd.prototype.__defineSetter__("matrix",function(a){(!y(a)||!(a instanceof id))&&i(Error("Invalid matrix."));this.C=a;this.o()});t=kd.prototype;t.Gi=function(a){(!D(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.C=this.C.rotate(a*Math.PI/180,new M(0,1,0));this.o()};
t.Hi=function(a){(!D(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.C=this.C.rotate(a*Math.PI/180,new M(1,0,0));this.o()};t.Ii=function(a){(!D(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.C=this.C.rotate(a*Math.PI/180,new M(0,0,1));this.o()};t.ej=function(a){D(a)||i(Error("Invalid distance."));this.C=this.C.translate(new M(a,0,0));this.o()};t.fj=function(a){D(a)||i(Error("Invalid distance."));this.C=this.C.translate(new M(0,a,0));this.o()};
t.gj=function(a){D(a)||i(Error("Invalid distance."));this.C=this.C.translate(new M(0,0,a));this.o()};function ld(a,b,c){var d=a.C.X(b,c);d||(d=0);a.C.k(b,c,-1*d);a.o()}t.uh=function(){ld(this,0,0)};t.vh=function(){ld(this,1,1)};t.wh=function(){ld(this,2,2)};t.o=function(){this.yf=new Float32Array(this.C.Fa());this.e=o};E("X.transform",kd);E("X.transform.prototype.rotateX",kd.prototype.Gi);E("X.transform.prototype.rotateY",kd.prototype.Hi);E("X.transform.prototype.rotateZ",kd.prototype.Ii);
E("X.transform.prototype.translateX",kd.prototype.ej);E("X.transform.prototype.translateY",kd.prototype.fj);E("X.transform.prototype.translateZ",kd.prototype.gj);E("X.transform.prototype.flipX",kd.prototype.uh);E("X.transform.prototype.flipY",kd.prototype.vh);E("X.transform.prototype.flipZ",kd.prototype.wh);E("X.transform.prototype.modified",kd.prototype.o);function pd(){K.call(this);this.c="texture";this.ua=this.mb=this.p=q;this.zb=this.Ab=0;va(this,new Pc)}G(pd,K);E("X.texture",pd);function N(a,b){K.call(this);this.c="triplets";this.Qb=Infinity;this.Nb=-Infinity;this.Rb=Infinity;this.Ob=-Infinity;this.Sb=Infinity;this.Pb=-Infinity;this.nd=[0,0,0];this.A=0;this.L=new Float32Array(a);y(b)&&(this.L=b.L.subarray(0,b.L.length),this.A=this.L.length,this.Qb=b.Qb,this.Nb=b.Nb,this.Rb=b.Rb,this.Ob=b.Ob,this.Sb=b.Sb,this.Pb=b.Pb,this.nd=b.nd.slice())}G(N,K);t=N.prototype;
t.add=function(a,b,c){this.Qb=Math.min(this.Qb,a);this.Nb=Math.max(this.Nb,a);this.Rb=Math.min(this.Rb,b);this.Ob=Math.max(this.Ob,b);this.Sb=Math.min(this.Sb,c);this.Pb=Math.max(this.Pb,c);this.nd=[(this.Qb+this.Nb)/2,(this.Rb+this.Ob)/2,(this.Sb+this.Pb)/2];this.e=o;this.L[this.A++]=a;this.L[this.A++]=b;this.L[this.A++]=c;return this.A/3};t.yc=function(){if(this.A!=this.L.length){var a=new Float32Array(this.A);a.set(this.L.subarray(0,this.A));this.L=a}};
t.get=function(a){a*=3;return[this.L[a],this.L[a+1],this.L[a+2]]};t.remove=function(){i(Error("Not implemented."))};t.clear=function(){this.L=new Float32Array(this.L.length);this.e=o};N.prototype.__defineGetter__("count",function(){this.yc();return this.L.length/3});N.prototype.__defineGetter__("length",function(){this.yc();return this.L.length});E("X.triplets",N);E("X.triplets.prototype.add",N.prototype.add);E("X.triplets.prototype.resize",N.prototype.yc);E("X.triplets.prototype.get",N.prototype.get);
E("X.triplets.prototype.remove",N.prototype.remove);E("X.triplets.prototype.clear",N.prototype.clear);function qd(){this.ka=rd;this.Yb=new kd;this.Hb=[1,1,1];this.Xb=this.w=this.Y=this.h=this.g=q;this.mc=[];this.La=o;this.lc=this.Nc=1;this.hc=q;this.Gc=r;this.Z=1;this.K=0}var rd="TRIANGLES";qd.prototype.__defineSetter__("type",function(a){return this.ka=a});qd.prototype.__defineGetter__("type",s("ka"));qd.prototype.__defineGetter__("texture",function(){this.w||(this.w=new pd);return this.w});qd.prototype.__defineGetter__("transform",s("Yb"));qd.prototype.__defineGetter__("points",s("g"));
qd.prototype.__defineSetter__("points",ba("g"));qd.prototype.__defineGetter__("normals",s("h"));qd.prototype.__defineSetter__("normals",ba("h"));qd.prototype.__defineGetter__("colors",s("Y"));qd.prototype.__defineSetter__("colors",ba("Y"));qd.prototype.__defineGetter__("color",s("Hb"));qd.prototype.__defineSetter__("color",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid color."));for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].color=a;this.Hb=a;this.e=o});
qd.prototype.__defineGetter__("opacity",s("Z"));qd.prototype.__defineSetter__("opacity",function(a){(!D(a)||1<a||0>a)&&i(Error("Invalid opacity."));for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].opacity=a;this.Z=a;this.e=o});qd.prototype.__defineGetter__("caption",s("hc"));qd.prototype.__defineSetter__("caption",function(a){this.hc=a;this.e=o});qd.prototype.__defineGetter__("visible",s("La"));
qd.prototype.__defineSetter__("visible",function(a){for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].visible=a;this.La=a;this.e=o});qd.prototype.__defineGetter__("pointsize",s("Nc"));qd.prototype.__defineSetter__("pointsize",function(a){D(a)||i(Error("Invalid point size."));this.Nc=a;this.e=o});qd.prototype.__defineGetter__("magicmode",s("Gc"));qd.prototype.__defineSetter__("magicmode",function(a){"boolean"!=typeof a&&i(Error("Invalid magic mode setting."));this.Gc=a;this.e=o});
qd.prototype.__defineGetter__("linewidth",s("lc"));qd.prototype.__defineSetter__("linewidth",function(a){D(a)||i(Error("Invalid line width."));this.lc=a;this.e=o});function sd(){this.Ka=Infinity;this.Q=this.Da=-Infinity;this.T=Infinity;this.vb=[0,0,0];this.tb=[1,1,1]}sd.prototype.__defineGetter__("lowerThreshold",s("Q"));sd.prototype.__defineSetter__("lowerThreshold",ba("Q"));sd.prototype.__defineGetter__("upperThreshold",s("T"));sd.prototype.__defineSetter__("upperThreshold",ba("T"));sd.prototype.__defineGetter__("min",s("Ka"));sd.prototype.__defineGetter__("max",s("Da"));sd.prototype.__defineGetter__("minColor",s("vb"));
sd.prototype.__defineSetter__("minColor",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid min. color."));this.vb=a});sd.prototype.__defineGetter__("maxColor",s("tb"));sd.prototype.__defineSetter__("maxColor",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid max. color."));this.tb=a});function td(){K.call(this);this.c="scalars";this.Bc=this.u=q;this.Jf=o;this.he=0;va(this,new Pc);va(this,new sd);this.vb=[0,1,0];this.tb=[1,0,0]}G(td,K);td.prototype.__defineGetter__("array",s("u"));td.prototype.__defineSetter__("array",function(a){this.Bc=this.u=a;this.e=o});td.prototype.__defineGetter__("interpolation",s("he"));td.prototype.__defineSetter__("interpolation",ba("he"));E("X.scalars",td);function R(a){K.call(this);this.c="object";this.d=[];this.t=this.aa=q;va(this,new qd);y(a)&&this.Zb(a)}G(R,K);
R.prototype.Zb=function(a){this.ka=a.ka;this.Yb=new kd;this.Yb.C=new id(a.Yb.C.W);this.Hb=a.Hb.slice();a.g&&(this.g=new N(a.g.length,a.g));a.h&&(this.h=new N(a.h.length,a.h));a.Y&&(this.Y=new N(a.Y.length,a.Y));this.w=a.w;this.Xb=a.Xb;a.p&&(this.p=new Oc((new String(a.p.wd)).toString()));this.Z=a.Z;this.d.length=0;var b=a.d;if(b)for(var c=b.length,d=0,d=0;d<c;d++)this.d.push(new H[b[d].c](b[d]));this.La=a.La;this.Nc=a.Nc;this.lc=a.lc;a.hc&&(this.hc=(new String(a.hc)).toString());this.Gc=a.Gc;this.mc=
a.mc.slice();this.e=o};R.prototype.__defineGetter__("colortable",function(){this.aa||(this.aa=new Qc);return this.aa});R.prototype.__defineGetter__("scalars",function(){this.t||(this.t=new td);return this.t});R.prototype.__defineGetter__("children",s("d"));R.prototype.o=function(){var a=new ud;a.da=this;this.dispatchEvent(a)};
function vd(a,b){(!y(a)||!y(b)||!(a instanceof R)||!(b instanceof R))&&i(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a.Z?-1:1==b.Z?1:y(a.K)&&y(b.K)&&a.K>b.K?-1:1}E("X.object",R);E("X.object.prototype.modified",R.prototype.o);function wd(){}function xd(a){for(var b=a.g.count,c=[],d=0,d=0;d<b;d+=3){var e=a.g.get(d),f=a.g.get(d+1),g=a.g.get(d+2),h=a.h.get(d),j=a.h.get(d+1),l=a.h.get(d+2),k=a.Hb;a.Y&&0<a.Y.length&&(k=a.Y.get(d));var n=[];n.push(new Ec(e,h));n.push(new Ec(f,j));n.push(new Ec(g,l));c.push(new Jc(n,k))}return Mc(c)}
function yd(a,b){(!y(b)||!(b instanceof Lc))&&i(Error("Invalid CSG object."));var c=new Nc,d=[];xb(b.z,function(a){for(var b=[],g=a.ce,b=xb(a.kb,function(a){a.color=g;return c.add(a)}),a=a=2;a<b.length;a++)d.push([b[0],b[a-1],b[a]])}.bind(a));a.Vg=xb(c.unique(),function(a){return[a.ya.x(),a.ya.y(),a.ya.b()]});a.Ug=xb(c.unique(),function(a){return[a.ea.x(),a.ea.y(),a.ea.b()]});a.Tg=xb(c.unique(),function(a){return!a.color?q:[a.color[0],a.color[1],a.color[2]]});a.g=new N(9*d.length);a.h=new N(9*d.length);
a.Y=new N(9*d.length);xb(d,function(a){var b=a[0],c=a[1],a=a[2],d=this.Vg,j=this.Ug,l=this.Tg;this.g.add(d[b][0],d[b][1],d[b][2]);this.g.add(d[c][0],d[c][1],d[c][2]);this.g.add(d[a][0],d[a][1],d[a][2]);this.h.add(j[b][0],j[b][1],j[b][2]);this.h.add(j[c][0],j[c][1],j[c][2]);this.h.add(j[a][0],j[a][1],j[a][2]);l[b]&&this.Y.add(l[b][0],l[b][1],l[b][2]);l[c]&&this.Y.add(l[c][0],l[c][1],l[c][2]);l[a]&&this.Y.add(l[a][0],l[a][1],l[a][2])}.bind(a));0==a.Y.A&&(a.Y=q);a.ka=rd}
wd.prototype.of=function(a){(!y(a)||!(a instanceof Lc)&&!(a instanceof R))&&i(Error("Invalid object."));var b=a;a instanceof R&&(b=xd(b));a=new R;va(a,new wd);yd(a,xd(this).of(b));return a};wd.prototype.Ta=function(a){(!y(a)||!(a instanceof Lc)&&!(a instanceof R))&&i(Error("Invalid object."));var b=a;a instanceof R&&(b=xd(b));a=new R;va(a,new wd);yd(a,xd(this).Ta(b));return a};
wd.prototype.Re=function(a){(!y(a)||!(a instanceof Lc)&&!(a instanceof R))&&i(Error("Invalid object."));var b=a;a instanceof R&&(b=xd(b));a=new R;va(a,new wd);yd(a,xd(this).Re(b));return a};wd.prototype.inverse=function(){var a=new R;va(a,new wd);yd(a,xd(this).inverse());return a};E("X.constructable",wd);E("X.constructable.prototype.intersect",wd.prototype.Re);E("X.constructable.prototype.inverse",wd.prototype.inverse);E("X.constructable.prototype.subtract",wd.prototype.Ta);
E("X.constructable.prototype.union",wd.prototype.of);function zd(a){jc.call(this,a);this.c="event"}G(zd,jc);var Ad=Cc("pan"),Bd=Cc("rotate"),Cd=Cc("zoom"),Dd=Cc("scroll");Cc("render");var Ed=Cc("resetview"),Fd=Cc("windowlevel"),yc=Cc("modified"),Gd=Cc("progress"),Hd=Cc("hover"),Jd=Cc("hover_end");function Kd(){zd.call(this,Fd);this.ne=this.Ae=0}G(Kd,zd);function Ld(){zd.call(this,Ad);this.K=new Xc(0,0)}G(Ld,zd);function Md(){zd.call(this,Bd);this.K=new Xc(0,0)}G(Md,zd);function Nd(){zd.call(this,Cd);this.Ja=this.Wa=r}G(Nd,zd);
function Od(){zd.call(this,Dd);this.I=r}G(Od,zd);function Pd(){zd.call(this,Hd);this.Fd=this.Ed=0}G(Pd,zd);function Qd(){zd.call(this,Jd)}G(Qd,zd);function Rd(){zd.call(this,Ed)}G(Rd,zd);function ud(){zd.call(this,yc);this.s=this.da=q}G(ud,zd);function Sd(){zd.call(this,Gd);this.Lf=0}G(Sd,zd);function Td(){K.call(this);this.c="parser";this.ba=q;this.A=0;this.Yg=0<(new Int8Array((new Int16Array([1])).buffer))[0];this.sd=o}G(Td,K);Td.prototype.parse=function(){i(Error("The function parse() should be overloaded."))};function Ud(a){for(var b=Infinity,c=-Infinity,d=a.length,e=0,e=0;e<d;e++)var f=a[e],b=Math.min(b,f),c=Math.max(c,f);return[b,c]}function Vd(a,b,c){b===m&&(b=0);c===m&&(c=a.length);for(var d="",e=0,e=b;e<c;++e)d+=String.fromCharCode(a[e]);return d}
function V(a,b,c){y(c)||(c=1);var d=1,e=Uint8Array;switch(b){case "schar":e=Int8Array;break;case "ushort":e=Uint16Array;d=2;break;case "sshort":e=Int16Array;d=2;break;case "uint":e=Uint32Array;d=4;break;case "sint":e=Int32Array;d=4;break;case "float":e=Float32Array,d=4}b=new e(a.ba.slice(a.A,a.A+=c*d));if(a.Yg!=a.sd){a=b;b=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);for(e=0;e<a.byteLength;e+=d)for(var f=e+d-1,g=e;f>g;f--,g++){var h=b[g];b[g]=b[f];b[f]=h}b=a}return 1==c?b[0]:b}
function Wd(a,b,c){H.Ia(a.c+".reslice");var d=b.ca,e=c.max,f=c.data,g=d[2],h=d[1],d=d[0],j=b.n!=q,l=h*d,k=Array(g),n=Array(g),v=0,p=q;b.aa&&(p=b.aa.sb);for(var w=0,u=0,z=0,C=0,x=4*l,w=0;w<g;w++){k[w]=Array(h);n[w]=Array(h);for(var A=f.subarray(w*l,(w+1)*l),F=new Uint8Array(x),u=C=0;u<h;u++){k[w][u]=new c.data.constructor(d);n[w][u]=new c.data.constructor(d);for(z=0;z<d;z++){var v=A[C],I=0,S=0,O=0,P=0;p?(P=p.get(Math.floor(v)),P||(I=p.Pa(),P=I[I.length-1]),I=255*P[1],S=255*P[2],O=255*P[3],P=255*P[4]):
(I=S=O=255*(v/e),P=255);var ea=4*C;F[ea]=I;F[++ea]=S;F[++ea]=O;F[++ea]=P;k[w][u][z]=255*(v/e);n[w][u][z]=v;C++}}v=new pd;v.ua=F;v.Ab=d;v.zb=h;A=b.gb.d[w];A.w=v;j&&(A.n=b.n.gb.d[w].w)}b.te&&(d!=h?j?b.aa?(Xd(g,d,h,n,b.aa,b.S,b.n.S,o),Xd(g,h,d,n,b.aa,b.R,b.n.R,r)):(Yd(g,d,h,k,b.S,b.n.S,o),Yd(g,h,d,k,b.R,b.n.R,r)):b.aa?(Xd(g,d,h,n,b.aa,b.S,q,o),Xd(g,h,d,n,b.aa,b.R,q,r)):(Yd(g,d,h,k,b.S,q,o),Yd(g,h,d,k,b.R,q,r)):j?b.aa?$d(g,d,h,k,b.aa,b.R,b.n.R,b.S,b.n.S):ae(g,d,h,k,b.R,b.n.R,b.S,b.n.S):b.aa?$d(g,d,h,
n,b.aa,b.R,q,b.S,q):ae(g,d,h,k,b.R,q,b.S,q));H.Ca(a.c+".reslice");return n}function Yd(a,b,c,d,e,f,g){for(var h=4*a*b,j=0,j=0;j<c;j++){for(var l=new Uint8Array(h),k=0,n=0,k=0;k<a;k++)for(var v=0,p=d[k],v=0;v<b;v++){var w,u=w=g?p[j][v]:p[v][j],z=w,C=4*n;l[C]=w;l[++C]=u;l[++C]=z;l[++C]=255;n++}k=new pd;k.ua=l;k.Ab=b;k.zb=a;l=e.d[j];l.w=k;f&&(l.n=f.d[j].w)}}
function Xd(a,b,c,d,e,f,g,h){for(var e=e.sb,j=4*a*b,l=0,l=0;l<c;l++){for(var k=new Uint8Array(j),n=0,v=0,n=0;n<a;n++)for(var p=d[n],w=0,w=0;w<b;w++){var u=e.get(Math.floor(h?p[l][w]:p[w][l]));u||(u=e.Pa(),u=u[u.length-1]);var z=255*u[2],C=255*u[3],x=255*u[4],A=4*v;k[A]=255*u[1];k[++A]=z;k[++A]=C;k[++A]=x;v++}n=new pd;n.ua=k;n.Ab=b;n.zb=a;k=f.d[l];k.w=n;g&&(k.n=g.d[l].w)}}
function ae(a,b,c,d,e,f,g,h){for(var j=4*a*b,l=0,l=0;l<c;l++){for(var k=new Uint8Array(j),n=new Uint8Array(j),v=0,p=0,p=0;p<a;p++)for(var w=d[p],u=0,u=0;u<b;u++){var z=w[u][l],C=z,x=z,A=4*v;k[A]=z;k[++A]=C;k[++A]=x;k[++A]=255;x=C=z=A=w[l][u];A=4*v;n[A]=z;n[++A]=C;n[++A]=x;n[++A]=255;v++}v=new pd;v.ua=k;v.Ab=b;v.zb=a;k=e.d[l];k.w=v;f&&(k.n=f.d[l].w);k=new pd;k.ua=n;k.Ab=b;k.zb=a;n=g.d[l];n.w=k;h&&(n.n=h.d[l].w)}}
function $d(a,b,c,d,e,f,g,h,j){for(var e=e.sb,l=4*a*b,k=0,k=0;k<c;k++){for(var n=new Uint8Array(l),v=new Uint8Array(l),p=0,w=0,w=0;w<a;w++)for(var u=d[w],z=0,z=0;z<b;z++){var C=e.get(Math.floor(u[z][k]));if(!C)var x=e.Pa(),C=x[x.length-1];var A=255*C[2],F=255*C[3],I=255*C[4],x=4*p;n[x]=255*C[1];n[++x]=A;n[++x]=F;n[++x]=I;x=e.get(Math.floor(u[k][z]));x||(x=e.Pa(),x=x[x.length-1]);C=255*x[1];A=255*x[2];F=255*x[3];I=255*x[4];x=4*p;v[x]=C;v[++x]=A;v[++x]=F;v[++x]=I;p++}p=new pd;p.ua=n;p.Ab=b;p.zb=a;n=
f.d[k];n.w=p;g&&(n.n=g.d[k].w);n=new pd;n.ua=v;n.Ab=b;n.zb=a;v=h.d[k];v.w=n;j&&(v.n=j.d[k].w)}};function be(){Td.call(this);this.c="parserLBL"}G(be,Td);
be.prototype.parse=function(a,b,c){H.Ia(this.c+".parse");var d=b.mc,e=d.length;0==e&&i(Error("No _pointIndices defined on the X.object."));this.ba=c;for(var f=[],g=V(this,"uchar",c.byteLength),h=g.length,j=r,l=0,c=1;c<h;c++)10==g[c-1]?(l=c,j=o):j&&32==g[c]&&(f.push(parseInt(Vd(g,l,c),10)),j=r);g=b.t.u?b.t.u:new Float32Array(e);h=f.length;for(c=0;c<h;c++)g[f[c]]=1;f=new Float32Array(3*e);for(c=h=0;c<e;c++)j=d[c],j>e&&i(Error("Could not find scalar for vertex.")),j=g[j],f[h++]=j,f[h++]=j,f[h++]=j;b.t.u=
g;b.t.Bc=f;b.t.e=o;H.Ca(this.c+".parse");d=new ud;d.da=b;d.s=a;this.dispatchEvent(d)};E("X.parserLBL",be);E("X.parserLBL.prototype.parse",be.prototype.parse);function ce(a){this.q=a;this.kg=J(this.q,Va?"DOMMouseScroll":"mousewheel",this)}G(ce,Dc);
ce.prototype.handleEvent=function(a){var b=0,c=0,d=0,a=a.Ea;if("mousewheel"==a.type){c=1;if(Ua||Wa&&(Na||kb("532.0")))c=40;d=Wa&&Ma&&0!=-a.wheelDelta%c?-a.wheelDelta:-a.wheelDelta/c;ga(a.wheelDeltaX)?(b=Wa&&Ma&&0!=-a.wheelDeltaX%c?-a.wheelDeltaX:-a.wheelDeltaX/c,c=Wa&&Ma&&0!=-a.wheelDeltaY%c?-a.wheelDeltaY:-a.wheelDeltaY/c):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),ga(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;D(this.mg)&&Math.min(Math.max(b,-this.mg),this.mg);D(this.ng)&&(c=Math.min(Math.max(c,
-this.ng),this.ng));b=new de(d,a,0,c);try{this.dispatchEvent(b)}finally{b.Oa()}};ce.prototype.O=function(){ce.j.O.call(this);uc(this.kg);delete this.kg};function de(a,b,c,d){b&&this.ha(b,m);this.type="mousewheel";this.detail=a;this.qc=d}G(de,lc);Ua||Wa&&kb("525");var ee;function fe(a,b){var c;c=(c=a.className)&&"function"==typeof c.split?c.split(/\s+/):[];var d=Db(arguments,1),e;e=c;for(var f=0,g=0;g<d.length;g++)0<=vb(e,d[g])||(e.push(d[g]),f++);e=f==d.length;a.className=c.join(" ");return e};var ge=!Ua||mb(9);!Va&&!Ua||Ua&&mb(9)||Va&&kb("1.9.1");Ua&&kb("9");function he(a){return a?new ie(je(a)):ee||(ee=new ie)}function ke(a){return ia(a)?document.getElementById(a):a}function le(a,b){nb(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in me?a.setAttribute(me[d],b):0==d.lastIndexOf("aria-",0)?a.setAttribute(d,b):a[d]=b})}
var me={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};function ne(a,b,c){return oe(document,arguments)}
function oe(a,b){var c=b[0],d=b[1];if(!ge&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',ya(d.name),'"');if(d.type){c.push(' type="',ya(d.type),'"');var e={};rb(e,d);d=e;delete d.type}c.push(">");c=c.join("")}c=a.createElement(c);d&&(ia(d)?c.className=d:B(d)?fe.apply(q,[c].concat(d)):le(c,d));2<b.length&&qe(a,c,b);return c}
function qe(a,b,c){function d(c){c&&b.appendChild(ia(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];ha(f)&&!(ka(f)&&0<f.nodeType)?wb(re(f)?Cb(f):f,d):d(f)}}function se(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function te(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}
function ue(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function je(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function re(a){if(a&&"number"==typeof a.length){if(ka(a))return"function"==typeof a.item||"string"==typeof a.item;if(ja(a))return"function"==typeof a.item}return r}function ie(a){this.P=a||ca.document||document}t=ie.prototype;
t.Nd=he;t.i=function(a){return ia(a)?this.P.getElementById(a):a};t.Og=ie.prototype.i;t.oc=function(a,b,c){return oe(this.P,arguments)};t.createElement=function(a){return this.P.createElement(a)};t.createTextNode=function(a){return this.P.createTextNode(a)};function ve(a){return"CSS1Compat"==a.P.compatMode}function we(a){var b=a.P,a=!Wa&&"CSS1Compat"==b.compatMode?b.documentElement:b.body,b=b.parentWindow||b.defaultView;return new Vc(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}
t.appendChild=function(a,b){a.appendChild(b)};t.contains=ue;function W(a){(!y(a)||!(a instanceof Element))&&i(Error("Could not add interactor to the given element."));K.call(this);this.c="interactor";this.qa=a;this.pe=this.Cf=this.Bf=this.Df=this.Af=this.Ef=q;this.oe=o;this.Bb=this.ub=this.eb=r;this.vd=[0,0];this.je=new Xc(0,0);this.Fc=new Xc(0,0);this.hg=0;this.Kf=this.rd=q;this.J={MOUSEWHEEL_ENABLED:o,MOUSECLICKS_ENABLED:o,KEYBOARD_ENABLED:o,HOVERING_ENABLED:o,CONTEXTMENU_ENABLED:r,TOUCH_ENABLED:o,TOUCH_BOUNCING_ENABLED:r}}G(W,K);
W.prototype.__defineGetter__("config",s("J"));W.prototype.__defineGetter__("leftButtonDown",s("eb"));W.prototype.__defineGetter__("middleButtonDown",s("ub"));W.prototype.__defineGetter__("rightButtonDown",s("Bb"));
W.prototype.ha=function(){this.J.MOUSEWHEEL_ENABLED?(this.pe=new ce(this.qa),this.Ef=J(this.pe,"mousewheel",this.dd.bind(this))):(uc(this.Ef),this.pe=q);this.J.MOUSECLICKS_ENABLED?(this.Af=J(this.qa,"mousedown",this.Yh.bind(this)),this.Df=J(this.qa,"mouseup",this.ci.bind(this))):(uc(this.Af),uc(this.Df));this.qa.oncontextmenu=this.J.CONTEXTMENU_ENABLED?q:function(){return r};window.onkeydown=this.J.KEYBOARD_ENABLED?this.sg.bind(this):q;this.J.TOUCH_ENABLED?(this.J.TOUCH_BOUNCING_ENABLED||document.body.addEventListener("touchmove",
function(a){a.preventDefault()},r),this.bh=J(this.qa,"touchstart",this.qi.bind(this)),this.ah=J(this.qa,"touchmove",this.oi.bind(this)),this.$g=J(this.qa,"touchend",this.ki.bind(this))):(uc(this.bh),uc(this.ah),uc(this.$g));uc(this.Bf);uc(this.Cf);this.Bf=J(this.qa,"mousemove",this.$h.bind(this));this.Cf=J(this.qa,"mouseout",this.ai.bind(this))};
W.prototype.Yh=function(a){0==a.button?this.eb=o:1==a.button?this.ub=o:2==a.button&&(this.Bb=o);eval("this.onMouseDown("+this.eb+","+this.ub+","+this.Bb+")");xe(this);a.preventDefault()};W.prototype.Xh=aa();W.prototype.ci=function(a){0==a.button?this.eb=r:1==a.button?this.ub=r:2==a.button&&(this.Bb=r);eval("this.onMouseUp("+this.eb+","+this.ub+","+this.Bb+")");xe(this);a.preventDefault()};W.prototype.__defineGetter__("mousePosition",s("vd"));t=W.prototype;t.bi=aa();
t.ai=function(a){this.oe=r;this.J.KEYBOARD_ENABLED&&(window.onkeydown=q);this.Bb=this.ub=this.eb=r;xe(this);this.je=new Xc(0,0);a.preventDefault()};t.Zh=aa();t.qi=function(a){a.preventDefault();a.ha(a.Ea.targetTouches[0],a.currentTarget);eval("this.onTouchStart("+a.clientX+","+a.clientY+")");this.Fc=new Xc(a.clientX,a.clientY);this.Kf=setTimeout(this.mi.bind(this,a),500)};t.pi=aa();
t.mi=function(a){eval("this.onTouchHover("+a.clientX+","+a.clientY+")");a=new Nd;a.Wa=o;a.Ja=this instanceof ye;this.dispatchEvent(a);this.Bd=o};t.li=aa();function ze(a){clearTimeout(a.Kf);if(a.Bd){var b=new Nd;b.Wa=r;b.Ja=a instanceof ye;a.dispatchEvent(b)}a.Bd=r}t.ki=function(a){a.preventDefault();eval("this.onTouchEnd()");ze(this)};t.ji=aa();
t.oi=function(a){a.preventDefault();this.Bd||ze(this);this.touchmoveEvent=a=a.Ea;eval("this.onTouchMove(this['touchmoveEvent'])");var b=a.targetTouches;if(1==b.length){var a=b[0],c=[a.clientX,a.clientY],a=new Xc(c[0],c[1]),b=c[0]>3*this.qa.clientWidth/4,d=c[0]<this.qa.clientWidth/4,e=c[1]<this.qa.clientHeight/4,c=c[1]>3*this.qa.clientHeight/4,c=!b&&!d&&!e&&!c,e=this.Fc.Ta(a);this.Fc=a.f();if(this.Bd)a=new Ld,5<e.x?e.x=1:-5>e.x&&(e.x=-1),5<e.y?e.y=1:-5>e.y&&(e.y=-1),a.K=e,this.dispatchEvent(a);else if(this instanceof
Ae&&(b||d))a=new Od,a.I=0>e.y,this.dispatchEvent(a);else if(this instanceof ye||c)e.scale(3),a=new Md,a.K=e,this.dispatchEvent(a)}else 2==b.length&&(a=b[0],b=b[1],a=[a.clientX,a.clientY],b=[b.clientX,b.clientY],a=new Xc(a[0],a[1]),e=Yc(a,new Xc(b[0],b[1])),b=e-this.hg,this.hg=e,this.Fc.Ta(a),this.Fc=a.f(),10<Math.abs(b)&&(a=new Nd,a.Wa=0<b,a.Ja=this instanceof ye,this.dispatchEvent(a)))};t.ni=aa();
t.$h=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.oe=o;this.J.KEYBOARD_ENABLED&&window.onkeydown==q&&(window.onkeydown=this.sg.bind(this));a.preventDefault();var b=a.shiftKey;this.vd=[a.offsetX,a.offsetY];var c=new Xc(this.vd[0],this.vd[1]),a=this.je.Ta(c);this.je=c.f();this.J.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.ub||this.eb||this.Bb)&&xe(this),this.rd=setTimeout(function(){xe(this);var a=new Pd;a.Ed=c.x;a.Fd=c.y;this.dispatchEvent(a);
this.rd=q}.bind(this),300));2>Math.abs(a.x)&&(a.x=0);2>Math.abs(a.y)&&(a.y=0);0!=a.cc()&&(this.eb&&!b?(b=new Md,a.scale(3),b.K=a,this.dispatchEvent(b)):this.ub||this.eb&&b?(b=new Ld,5<a.x?a.x=5:-5>a.x&&(a.x=-5),5<a.y?a.y=5:-5>a.y&&(a.y=-5),b.K=a,this.dispatchEvent(b)):this.Bb&&(b=new Nd,b.Wa=0<a.y,b.Ja=r,this.dispatchEvent(b)))};function xe(a){a.rd&&clearTimeout(a.rd);a.dispatchEvent(new Qd)}t.di=aa();
t.dd=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");xe(this);a.preventDefault()};t.Vh=aa();
t.sg=function(a){if(this.oe){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");xe(this);var b=a.altKey,c=a.ctrlKey,d=a.metaKey,e=a.shiftKey,f=a.keyCode;82==f&&!b&&!c&&!d&&!e?(a.preventDefault(),a=new Rd,this.dispatchEvent(a)):37<=f&&40>=f&&(a.preventDefault(),e?a=new Ld:b?a=new Nd:(a=new Md,this instanceof Ae&&(a=new Od)),a&&(c=new Xc(0,0),37==f?(c.x=5,a.I=r,b&&(a.I=o,a.Wa=o,a.Ja=r)):39==f?(c.x=-5,a.I=o,b&&(a.Wa=r,a.Ja=r)):38==f?(c.y=5,a.I=o,b&&(a.Wa=o,a.Ja=o)):40==f&&(c.y=-5,a.I=r,b&&(a.Wa=r,
a.Ja=o)),a.K=c,this.dispatchEvent(a)))}};E("X.interactor",W);E("X.interactor.prototype.init",W.prototype.ha);E("X.interactor.prototype.onMouseDown",W.prototype.Xh);E("X.interactor.prototype.onMouseUp",W.prototype.bi);E("X.interactor.prototype.onMouseMove",W.prototype.Zh);E("X.interactor.prototype.onMouseWheel",W.prototype.di);E("X.interactor.prototype.onKey",W.prototype.Vh);E("X.interactor.prototype.onTouchStart",W.prototype.pi);E("X.interactor.prototype.onTouchMove",W.prototype.ni);
E("X.interactor.prototype.onTouchEnd",W.prototype.ji);E("X.interactor.prototype.onTouchHover",W.prototype.li);function Ae(a){W.call(this,a);this.c="interactor2D"}G(Ae,W);Ae.prototype.dd=function(a){Ae.j.dd.call(this,a);var b=new Od;y(a.qc)||(a.qc=0);b.I=0>a.qc;this.dispatchEvent(b)};function Be(a){R.call(this);this.c="slice";this.l=[0,0,0];this.jc=[0,0,1];this.I=[0,1,0];this.G=this.M=10;this.Xb=[0,1,0,0,1,1,1,1,1,0,0,0];this.n=this.ib=q;this.Va=o;this.gc=[1,1,1];y(a)&&this.Zb(a)}G(Be,R);Be.prototype.Zb=function(a){this.l=a.l.slice();this.jc=a.jc.slice();this.I=a.I.slice();this.M=a.M;this.G=a.G;this.ib=a.ib;this.n=a.n;this.Va=a.Va;this.gc=a.gc;this.Xg=a.Xg;Be.j.Zb.call(this,a)};
Be.prototype.pc=function(){var a=new M(this.jc[0],this.jc[1],this.jc[2]),b=new M(this.I[0],this.I[1],this.I[2]),c=Uc(b,a),d=new M(this.l[0],this.l[1],this.l[2]),e=new M(1,1,1);1==a.x?(e=new M(this.l[0],this.G/2,this.M/2),this.Xb=[0,0,1,0,0,1,0,1,1,1,1,0]):1==a.y?(e=new M(this.M/2,this.l[1],this.G/2),this.Xb=[0,0,0,1,1,0,1,0,1,1,0,1]):1==a.b&&(e=new M(this.M/2,this.G/2,this.l[2]));var f=Tc(c.f().$(),b.f().$()),f=new M(f.x*e.x,f.y*e.y,f.b*e.b);f.add(d);var g=Tc(c.f().$(),b),g=new M(g.x*e.x,g.y*e.y,
g.b*e.b);g.add(d);var h=Tc(c,b.f().$()),h=new M(h.x*e.x,h.y*e.y,h.b*e.b);h.add(d);var j=h,b=Tc(c,b),b=new M(b.x*e.x,b.y*e.y,b.b*e.b);b.add(d);d=g;this.g=new N(18);this.h=new N(18);this.g.add(f.x,f.y,f.b);this.g.add(g.x,g.y,g.b);this.g.add(h.x,h.y,h.b);this.g.add(j.x,j.y,j.b);this.g.add(b.x,b.y,b.b);this.g.add(d.x,d.y,d.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.Va&&(a=new R,a.g=new N(24),a.h=
new N(24),a.g.add(f.x,f.y,f.b),a.g.add(g.x,g.y,g.b),a.g.add(g.x,g.y,g.b),a.g.add(b.x,b.y,b.b),a.g.add(b.x,b.y,b.b),a.g.add(h.x,h.y,h.b),a.g.add(h.x,h.y,h.b),a.g.add(f.x,f.y,f.b),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.Hb=[this.gc[0],this.gc[1],this.gc[2]],a.ka="LINES",a.lc=2,this.d.push(a))};E("X.slice",Be);function L(a){R.call(this);this.c="volume";this.l=[0,0,0];this.ca=[10,10,10];this.H=[1,1,1];this.mb=[];this.Ec=this.pb=this.Dc=this.ob=this.Cc=this.nb=0;this.R=new R;this.S=new R;this.gb=new R;this.Dd=this.Ma=r;this.Cb=0;this.n=q;this.Va=o;this.V=Infinity;this.U=-Infinity;this.te=o;va(this,new Pc);va(this,new sd);y(a)&&this.Zb(a)}G(L,R);
L.prototype.Zb=function(a){window.console.log(a);this.l=a.l.slice();this.ca=a.ca.slice();this.H=a.H.slice();this.nb=a.nb;this.Cc=a.Cc;this.ob=a.ob;this.Dc=a.Dc;this.pb=a.pb;this.Ec=a.Ec;this.R=new R(a.R);this.S=new R(a.S);this.gb=new R(a.gb);this.Ma=a.Ma;this.Dd=a.Dd;this.Cb=a.Cb;this.n=a.n;this.Va=a.Va;L.j.Zb.call(this,a)};
L.prototype.pc=function(){this.d.length=0;this.R.d.length=0;this.S.d.length=0;this.gb.d.length=0;this.d.push(this.R);this.d.push(this.S);this.d.push(this.gb);for(var a=0,a=0;3>a;a++){for(var b=(this.ca[a]-1)/2,c=b,d=0,d=0;d<this.ca[a];d++){var e=-b*this.H[a]+d*this.H[a],f=[[this.l[0]+e,this.l[1],this.l[2]],[this.l[0],this.l[1]+e,this.l[2]],[this.l[0],this.l[1],this.l[2]+e]],e=this.d[a].d,g=0,h=0,j=[1,1,1],l=this.Va;0==a?(g=this.ca[2]*this.H[2]-this.H[2],h=this.ca[1]*this.H[1]-this.H[1],j=[1,1,0]):
1==a?(g=this.ca[0]*this.H[0]-this.H[0],h=this.ca[2]*this.H[2]-this.H[2],j=[1,0,0]):2==a&&(g=this.ca[0]*this.H[0]-this.H[0],h=this.ca[1]*this.H[1]-this.H[1],j=[0,1,0]);y(this.ib)&&(l=r);var k=new Be,n=k,f=f[a],v=[[1,0,0],[0,1,0],[0,0,1]][a],p=[[0,1,0],[0,0,-1],[0,1,0]][a];(!y(f)||!B(f)||3!=f.length)&&i(Error("Invalid center."));(!y(v)||!B(v)||3!=v.length)&&i(Error("Invalid front direction."));(!y(p)||!B(p)||3!=p.length)&&i(Error("Invalid up direction."));D(g)||i(Error("Invalid width."));D(h)||i(Error("Invalid height."));
var w=r;y(l)&&(w=l);l=[1,1,1];y(j)&&(l=j);n.l=f;n.jc=v;n.I=p;n.M=g;n.G=h;n.Va=w;n.gc=l;n.pc();k.ib=this;k.visible=d==Math.floor(c);e.push(k)}0==a?this.Cc=this.nb=c:1==a?this.Dc=this.ob=c:2==a&&(this.Ec=this.pb=c)}this.e=o};
L.prototype.o=function(a){a="undefined"!==typeof a?a:o;if(0<this.d.length)if(this.Ma!=this.Dd&&(this.Ma?(this.d[0].d[parseInt(this.nb,10)].visible=r,this.d[1].d[parseInt(this.ob,10)].visible=r,this.d[2].d[parseInt(this.pb,10)].visible=r):this.d[this.Cb].visible=r,this.e=o,this.Dd=this.Ma),this.Ma)Ce(this,this.Cb);else for(var b=0,b=0;3>b;b++){var c=this.d[b],d=0,e=0;0==b?(d=this.nb,e=this.Cc,this.Cc=this.nb):1==b?(d=this.ob,e=this.Dc,this.Dc=this.ob):2==b&&(d=this.pb,e=this.Ec,this.Ec=this.pb);c.d[parseInt(e,
10)].visible=r;c=c.d[parseInt(d,10)];c.visible=o;c.Z=1}a&&L.j.o.call(this)};L.prototype.__defineGetter__("dimensions",s("ca"));L.prototype.__defineGetter__("volumeRendering",s("Ma"));L.prototype.__defineSetter__("volumeRendering",function(a){this.Ma=a;this.o(r)});L.prototype.__defineSetter__("visible",ba("La"));L.prototype.__defineGetter__("center",s("l"));L.prototype.__defineSetter__("center",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid center."));this.l=a});
L.prototype.__defineGetter__("image",s("mb"));L.prototype.__defineGetter__("labelmap",function(){this.n||(this.n=new De(this));return this.n});L.prototype.__defineGetter__("indexX",s("nb"));L.prototype.__defineSetter__("indexX",function(a){D(a)&&0<=a&&a<this.R.d.length&&(this.nb=a,this.o(r))});L.prototype.__defineGetter__("indexY",s("ob"));L.prototype.__defineSetter__("indexY",function(a){D(a)&&0<=a&&a<this.S.d.length&&(this.ob=a,this.o(r))});L.prototype.__defineGetter__("indexZ",s("pb"));
L.prototype.__defineSetter__("indexZ",function(a){D(a)&&0<=a&&a<this.gb.d.length&&(this.pb=a,this.o(r))});L.prototype.__defineGetter__("windowLow",s("V"));L.prototype.__defineSetter__("windowLow",ba("V"));L.prototype.__defineGetter__("windowHigh",s("U"));L.prototype.__defineSetter__("windowHigh",ba("U"));L.prototype.__defineGetter__("borders",s("Va"));L.prototype.__defineSetter__("borders",ba("Va"));L.prototype.__defineGetter__("reslicing",s("te"));L.prototype.__defineSetter__("reslicing",ba("te"));
function Ce(a,b){if(a.Ma&&(a.e||b!=a.Cb)){var c=a.d[a.Cb];c.visible=r;var c=a.d[b],d=c.d.length,e;for(e=0;e<d;e++)c.d[e].La=o;a.Cb=b;a.e=r}}E("X.volume",L);E("X.volume.prototype.modified",L.prototype.o);function Ee(){Td.call(this);this.c="parserSTL"}G(Ee,Td);
Ee.prototype.parse=function(a,b,c){H.Ia(this.c+".parse");this.ba=c;var d=b.g,e=b.h;if("solid"==Vd(V(this,"uchar",5))){b.g=d=new N(c.byteLength);b.h=e=new N(c.byteLength);var f=d,d=e,e=V(this,"uchar",c.byteLength-5),c=e.length,g=r,h=r,j=0,l;for(l=0;l<c;l++)if(10==e[l]){if(g||h){var k=Vd(e,j,l).split(" "),h=parseFloat(k[0]),n=parseFloat(k[1]),k=parseFloat(k[2]);g?(d.add(h,n,k),d.add(h,n,k),d.add(h,n,k)):f.add(h,n,k);h=g=r}}else 32==e[l-1]&&(102==e[l]?(j=l+=13,g=o):118==e[l]&&(j=l+=7,h=o))}else{this.A=
80;f=V(this,"uint");b.g=d=new N(9*f);b.h=e=new N(9*f);for(c=c=0;c<f;c++)g=V(this,"float",12),j=g[0],l=g[1],h=g[2],e.add(j,l,h),e.add(j,l,h),e.add(j,l,h),d.add(g[3],g[4],g[5]),d.add(g[6],g[7],g[8]),d.add(g[9],g[10],g[11]),this.A+=2}H.Ca(this.c+".parse");f=new ud;f.da=b;f.s=a;this.dispatchEvent(f)};E("X.parserSTL",Ee);E("X.parserSTL.prototype.parse",Ee.prototype.parse);function Fe(a){function b(){Fc+=8;return Ka<qa.length?qa[Ka++]:-1}function c(){var a;Fc++;a=T&1;T>>=1;0==T&&(T=b(),a=T&1,T=T>>1|128);return a}function d(a){for(var b=0,d=a;d--;)b=b<<1|c();a&&(b=S[b]>>8-a);return b}function e(a){x[A++]=a;if(I==w-1){var b=new Uint8Array(2*w);b.set(p);p=b;w*=2}p[I++]=a;32768==A&&(A=0)}function f(){this.Hd=this.Gd=0;this.Se=q}function g(){for(;;){if(sb[Da]>=md)return-1;if(Gc[sb[Da]]==Da)return sb[Da]++;sb[Da]++}}function h(){var a=Hc[Jb],b;if(17==Da)return-1;Jb++;Da++;
b=g();if(0<=b)a.Gd=b;else if(a.Gd=32768,h())return-1;b=g();if(0<=b)a.Hd=b,a.Se=q;else if(a.Hd=32768,a.Se=Hc[Jb],a.Zj=Jb,h())return-1;Da--;return 0}function j(a,b,c){Hc=a;Jb=0;Gc=c;md=b;for(a=0;17>a;a++)sb[a]=0;Da=0;return h()?-1:0}function l(a){for(var b,d,e=0,f=a[e];;)if(b=c()){if(!(f.Hd&32768))return f.Hd;f=f.Se;b=a.length;for(d=0;d<b;d++)if(a[d]===f){e=d;break}}else{if(!(f.Gd&32768))return f.Gd;e++;f=a[e]}}function k(){var a,g,h,k,n;do if(a=c(),h=d(2),0==h){T=1;h=b();h|=b()<<8;for(b(),b();h--;)g=
b(),e(g)}else if(1==h)for(;;)if(h=S[d(7)]>>1,23<h?(h=h<<1|c(),199<h?(h-=128,h=h<<1|c()):(h-=48,143<h&&(h+=136))):h+=256,256>h)e(h);else if(256==h)break;else{var p;h-=257;n=d(P[h])+O[h];h=S[d(5)]>>3;8<Q[h]?(p=d(8),p|=d(Q[h]-8)<<8):p=d(Q[h]);p+=ea[h];for(h=0;h<n;h++)g=x[A-p&32767],e(g)}else if(2==h){var u=Array(320);g=257+d(5);p=1+d(5);k=4+d(4);for(h=0;19>h;h++)u[h]=0;for(h=0;h<k;h++)u[Z[h]]=d(3);n=ib.length;for(k=0;k<n;k++)ib[k]=new f;if(j(ib,19,u)){A=0;return}n=g+p;k=0;for(var v=-1;k<n;)if(v++,h=
l(ib),16>h)u[k++]=h;else if(16==h){var w;h=3+d(2);if(k+h>n){A=0;return}for(w=k?u[k-1]:0;h--;)u[k++]=w}else{h=17==h?3+d(3):11+d(7);if(k+h>n){A=0;return}for(;h--;)u[k++]=0}n=Lb.length;for(k=0;k<n;k++)Lb[k]=new f;if(j(Lb,g,u)){A=0;return}n=Lb.length;for(k=0;k<n;k++)ib[k]=new f;h=[];for(k=g;k<u.length;k++)h[k-g]=u[k];if(j(ib,p,h)){A=0;return}for(;;)if(h=l(Lb),256<=h){h-=256;if(0==h)break;h--;n=d(P[h])+O[h];h=l(ib);8<Q[h]?(p=d(8),p|=d(Q[h]-8)<<8):p=d(Q[h]);for(p+=ea[h];n--;)g=x[A-p&32767],e(g)}else e(h)}while(!a);
A=0;T=1}function n(){var a=[],c;u&8&&(a[0]=b(),a[1]=b(),a[2]=b(),a[3]=b(),80==a[0]&&75==a[1]&&7==a[2]&&8==a[3]&&(b(),b(),b(),b()),b(),b(),b(),b(),b(),b(),b(),b());F&&v(qa.byteLength);a[0]=b();if(8==a[0]){u=b();b();b();b();b();b();b();if(u&4){a[0]=b();a[2]=b();Da=a[0]+256*a[1];for(a=0;a<Da;a++)b()}if(u&8){a=0;for(tb=[];c=b();){if("7"==c||":"==c)a=0;a<nd-1&&(tb[a++]=c)}}if(u&16)for(;b(););u&2&&(b(),b());k();b();b();b();b();b();b();b();b();F&&v(qa.byteLength)}}function v(a){w=a;p=new Uint8Array(a);a=
[];F=r;a[0]=b();a[1]=b();120==a[0]&&218==a[1]&&(k(),C[z]=Array(2),C[z][0]=p,C[z][1]="geonext.gxt",z++);31==a[0]&&139==a[1]&&(n(),C[z]=Array(2),C[z][0]=p,C[z][1]="file",z++);if(80==a[0]&&75==a[1]&&(F=o,a[2]=b(),a[3]=b(),3==a[2]&&4==a[3])){a[0]=b();a[1]=b();u=b();u|=b()<<8;a=b();a|=b()<<8;b();b();b();b();b();b();b();b();b();b();b();b();b();b();b();b();var c=b(),c=c|b()<<8,d=b(),d=d|b()<<8,e=0;for(tb=[];c--;){var f=b();"/"==f|":"==f?e=0:e<nd-1&&(tb[e++]=String.fromCharCode(f))}od||(od=tb);for(e=0;e<
d;)b(),e++;I=0;8==a&&(k(),C[z]=Array(2),C[z][0]=p,C[z][1]=tb.join(""),z++);n()}}var p=q,w=0,u,z=0,C=[],x=Array(32768),A=0,F=r,I=0,S=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,
22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,
175,111,239,31,159,95,223,63,191,127,255],O=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],P=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],ea=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Q=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],qa=a,Ka=0,T=1,Fc=0,nd=256,tb=[],od,Lb=Array(288),ib=Array(32),
Jb=0,Hc=q,Da=0,sb=Array(17);sb[0]=0;var Gc,md;Fe.prototype.pf=function(){v(qa.byteLength);return p}};function Ge(){Td.call(this);this.c="parserDCM"}G(Ge,Td);Ge.prototype.parse=function(a,b,c){c=this.ed(c,b);if(c.Ud==c.$a){var d=c.kf.length,e,f=0;for(e=0;e<d;e++){var g=c.kf[e];g!==m&&(g*=c.cb,g=c.Uc.subarray(g,g+c.cb),c.data.set(g,f*c.cb),f++)}b.ca=[c.va[0],c.va[1],c.va[2]];Infinity==c.la[2]&&(c.la[2]=1);b.H=[c.la[0],c.la[1],c.la[2]];e=Ud(c.data);d=e[0];e=e[1];c.min=b.Ka=b.V=d;c.max=b.Da=b.U=e;-Infinity==b.Q&&(b.Q=d);Infinity==b.T&&(b.T=e);b.pc();b.mb=Wd(this,b,c)}c=new ud;c.da=b;c.s=a;this.dispatchEvent(c)};
Ge.prototype.ed=function(a,b){this.ba=a;var c=0;if(y(b.fc)){g=b.fc;h=V(this,"ushort",this.ba.byteLength-2*g.cb);j=0;for(l=2;0<l;)if(d=h[j++],32==d)if(f=h[j++],19==f){j++;d=h[j++];for(f=0;f<d/2;f++)k=h[j++],n=k&255,k=(k&65280)>>8,c+=String.fromCharCode(n),c+=String.fromCharCode(k),c=parseInt(c,10);l--}else if(4161==f){j++;for(var d=h[j++],e="",f=0;f<d/2;f++)k=h[j++],n=k&255,k=(k&65280)>>8,e+=String.fromCharCode(n),e+=String.fromCharCode(k);g.la=[g.la[0],g.la[1],Math.min(Math.abs(g.ig-e),g.la[2])];
g.ig=e;l--}g.va[2]++}else{var g={rows:0,cols:0,la:q,Ce:0,gh:0,$a:1,Th:1,ig:q,Ud:0,cb:0,Uc:q,ef:0,kf:[],data:q,min:Infinity,max:-Infinity};g.$a=b.p.length;y(g.$a)||(g.$a=1);for(var h=V(this,"ushort",this.ba.byteLength),j=66,d=q,f=q,d=q,l=7;0<l;)if(d=h[j++],8==d)f=h[j++],j++,d=h[j++],24==f&&(g.ck=j-2,g.Wi=d);else if(40==d)switch(f=h[j++],j++,d=h[j++],f){case 16:g.rows=h[j++];l--;break;case 17:g.cols=h[j++];l--;break;case 256:g.Ce=h[j++];l--;break;case 257:g.gh=h[j++];l--;break;case 2:g.Th=h[j++];l--;
break;case 48:e="";for(f=f=0;f<d/2;f++)var k=h[j++],n=k&255,k=(k&65280)>>8,e=e+String.fromCharCode(n),e=e+String.fromCharCode(k);e=e.split("\\");g.la=[+e[0],+e[1],Infinity];l--}else if(32==d&&(f=h[j++],19==f)){g.Yj=j-g.Wi;j++;d=h[j++];for(f=0;f<d/2;f++)k=h[j++],n=k&255,k=(k&65280)>>8,c+=String.fromCharCode(n),c+=String.fromCharCode(k),c=parseInt(c,10);l--}b.fc=g;g.va=[g.cols,g.rows,1];g.cb=g.rows*g.cols;switch(g.Ce){case 8:g.Uc=new Uint8Array(g.cols*g.rows*g.$a);g.data=new Uint8Array(g.cols*g.rows*
g.$a);break;case 16:g.Uc=new Uint16Array(g.cols*g.rows*g.$a);g.data=new Uint16Array(g.cols*g.rows*g.$a);break;case 32:g.Uc=new Uint32Array(g.cols*g.rows*g.$a),g.data=new Uint32Array(g.cols*g.rows*g.$a)}}this.A=this.ba.byteLength-2*g.cb;h=q;switch(g.Ce){case 8:h=V(this,"uchar",g.cb);break;case 16:h=V(this,"ushort",g.cb);break;case 32:h=V(this,"uint",g.cb)}g.kf[c]=g.ef;g.Uc.set(h,g.ef*g.cb);g.ef++;++g.Ud;return g};E("X.parserDCM",Ge);E("X.parserDCM.prototype.parse",Ge.prototype.parse);function He(){Td.call(this);this.c="parserVTK"}G(He,Td);
He.prototype.parse=function(a,b,c){H.Ia(this.c+".parse");var d=b.g,e=b.h,f=new Uint8Array(c),g="";b.g=d=new N(c.byteLength);b.h=e=new N(c.byteLength);for(var c=0,h=f.length;c<h;c+=32768)g+=Vd(f,c,Math.min(c+32768,h));f=g.split("\n");g=f.length;this.Qc=this.Rc=q;this.Kb=[];this.sa=rd;this.re=this.xb=this.lb=this.yb=r;c=0;for(h=g%8;h--;)Ie(this,f[c]),c++;for(h=0.125*g^0;h--;)Ie(this,f[c]),c++,Ie(this,f[c]),c++,Ie(this,f[c]),c++,Ie(this,f[c]),c++,Ie(this,f[c]),c++,Ie(this,f[c]),c++,Ie(this,f[c]),c++,
Ie(this,f[c]),c++;var c=this.Rc,f=this.Qc,g=f.length,j=h=this.Kb.length;do{var l=this.Kb[h-j],k=l.length,n;for(n=0;n<k&&!("LINES"==this.sa&&n+1>=k);n++){var v=parseInt(l[n],10),p=c.get(v);d.add(p[0],p[1],p[2]);var w=v,u=p;"LINES"==this.sa?(w=parseInt(l[n+1],10),u=c.get(w),d.add(u[0],u[1],u[2])):"TRIANGLE_STRIPS"==this.sa&&(0==n||n==k-1)&&d.add(p[0],p[1],p[2]);v<g?(u=f.get(v),e.add(u[0],u[1],u[2]),"LINES"==this.sa?(w=f.get(w),e.add(w[0],w[1],w[2])):"TRIANGLE_STRIPS"==this.sa&&(0==n||n==k-1)&&e.add(u[0],
u[1],u[2])):(w=new M(p[0],p[1],p[2]),w.normalize(),e.add(w.x,w.y,w.b),"LINES"==this.sa?(w=new M(u[0],u[1],u[2]),w.normalize(),e.add(w.x,w.y,w.b)):"TRIANGLE_STRIPS"==this.sa&&(0==n||n==k-1)&&e.add(w.x,w.y,w.b))}j--}while(0<j);b.ka=this.sa;H.Ca(this.c+".parse");d=new ud;d.da=b;d.s=a;this.dispatchEvent(d)};
function Ie(a,b){var b=b.replace(/^\s+|\s+$/g,""),c=b.split(" "),d=c.length,e=c[0];switch(e){case "POINTS":a.yb=o;a.lb=r;a.xb=r;c=parseInt(c[1],10);a.Rc=new N(3*c);a.Qc=new N(3*c);return;case "VERTICES":a.lb=o;a.yb=r;a.xb=r;c=parseInt(c[1],10);3<=c?a.sa=rd:1==c?a.sa="POINTS":i(Error("This VTK file is not supported!"));a.Kb=[];return;case "TRIANGLE_STRIPS":a.lb=o;a.yb=r;a.xb=r;a.sa="TRIANGLE_STRIPS";a.Kb=[];return;case "LINES":a.lb=o;a.yb=r;a.xb=r;a.sa="LINES";a.Kb=[];return;case "POLYGONS":a.lb=o;
a.yb=r;a.xb=r;a.sa="POLYGONS";a.Kb=[];return;case "POINT_DATA":a.xb=o;a.yb=r;a.lb=r;return}if(a.yb)if(1==d||isNaN(parseFloat(e)))a.yb=r;else{if(3<=d){var e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]);a.Rc.add(e,f,g)}6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.Rc.add(e,f,g));9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.Rc.add(d,e,c))}else a.lb?1==d||isNaN(parseFloat(e))?a.lb=r:a.Kb.push(c.slice(1)):a.xb&&("NORMALS"==e?a.re=o:1==d||isNaN(parseFloat(e))?
(a.xb=r,a.re=r):a.re&&(3<=d&&(e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]),a.Qc.add(e,f,g)),6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.Qc.add(e,f,g)),9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.Qc.add(d,e,c))))}E("X.parserVTK",He);E("X.parserVTK.prototype.parse",He.prototype.parse);function Je(){Td.call(this);this.c="parserFSM";this.sd=r}G(Je,Td);
Je.prototype.parse=function(a,b,c){H.Ia(this.c+".parse");this.ba=c;var d=b.g,e=b.h;b.mc=[];var f=b.mc,c=0,g;do g=V(this,"uchar"),c++;while(200>c&&10!=g);V(this,"uchar");var e=V(this,"uint"),c=V(this,"uint"),h=V(this,"float",3*e);g=V(this,"uint",3*c);var j=new Uint32Array(e),l=new Float32Array(9*c);b.g=d=new N(9*c);b.h=e=new N(9*c);var k;for(k=0;k<c;k++){var n=3*k,v=g[n],p=g[n+1],w=g[n+2];f.push(v);f.push(p);f.push(w);j[v]+=1;j[p]+=1;j[w]+=1;var n=3*v,u=3*p,z=3*w,C=h[n],x=h[n+1],A=h[n+2],p=h[u],w=
h[u+1],v=h[u+2],F=h[z],I=h[z+1],S=h[z+2];d.add(C,x,A);d.add(p,w,v);d.add(F,I,S);C=new M(C,x,A);F=new M(F,I,S);p=(new M(p,w,v)).f().Ta(C);w=F.f().Ta(C);p=Uc(p,w).normalize();l[n]+=p.x;l[n+1]+=p.y;l[n+2]+=p.b;l[u]+=p.x;l[u+1]+=p.y;l[u+2]+=p.b;l[z]+=p.x;l[z+1]+=p.y;l[z+2]+=p.b}for(k=0;k<c;k++)n=3*k,v=g[n],p=g[n+1],w=g[n+2],n=3*v,u=3*p,z=3*w,f=new M(l[u],l[u+1],l[u+2]),h=new M(l[z],l[z+1],l[z+2]),n=(new M(l[n],l[n+1],l[n+2])).scale(1/j[v]).normalize(),f=f.scale(1/j[p]).normalize(),h=h.scale(1/j[w]).normalize(),
e.add(n.x,n.y,n.b),e.add(f.x,f.y,f.b),e.add(h.x,h.y,h.b);b.ka=rd;H.Ca(this.c+".parse");c=new ud;c.da=b;c.s=a;this.dispatchEvent(c)};E("X.parserFSM",Je);E("X.parserFSM.prototype.parse",Je.prototype.parse);function Ke(){Td.call(this);this.c="parserMGZ";this.sd=r}G(Ke,Td);Ke.prototype.parse=function(a,b,c,d){H.Ia(this.c+".parse");var e=c;d&&(e=(new Fe(new Uint8Array(c))).pf(),e=e.buffer);c=this.ed(e);b.ca=[c.Ve,c.We,c.Xe];b.H=c.Kg;d=c.min;e=c.max;b.Ka=b.V=d;b.Da=b.U=e;-Infinity==b.Q&&(b.Q=d);Infinity==b.T&&(b.T=e);b.pc();H.Ca(this.c+".parse");b.mb=Wd(this,b,c);c=new ud;c.da=b;c.s=a;this.dispatchEvent(c)};
Ke.prototype.ed=function(a){this.ba=a;a={version:0,Sg:0,Qg:0,xh:0,Rg:0,Ve:0,We:0,Xe:0,Sh:0,type:0,qh:0,Bg:0,nj:q,Pg:q,Kg:q,data:q,min:Infinity,max:-Infinity};a.version=V(this,"uint");a.Ve=V(this,"uint");a.We=V(this,"uint");a.Xe=V(this,"uint");a.Sh=V(this,"uint");a.type=V(this,"uint");a.qh=V(this,"uint");a.Bg=V(this,"ushort");if(0<a.Bg){a.Kg=V(this,"float",3);var b=[];b.push(V(this,"float",3));b.push(V(this,"float",3));b.push(V(this,"float",3));b.push(V(this,"float",3));a.Pg=b}this.A=284;b=a.Ve*a.We*
a.Xe;switch(a.type){case 0:a.data=V(this,"uchar",b);break;case 1:a.data=V(this,"uint",b);break;case 3:a.data=V(this,"float",b);break;case 4:a.data=V(this,"ushort",b);break;default:i(Error("Unsupported MGH/MGZ data type: "+a.type))}b=Ud(a.data);a.min=b[0];a.max=b[1];this.A+16<this.ba.byteLength&&(a.Sg=V(this,"float"),a.xh=V(this,"float"),a.Qg=V(this,"float"),a.Rg=V(this,"float"));return a};E("X.parserMGZ",Ke);E("X.parserMGZ.prototype.parse",Ke.prototype.parse);function Le(){Td.call(this);this.c="parserCRV";this.sd=r}G(Le,Td);
Le.prototype.parse=function(a,b,c){H.Ia(this.c+".parse");var d=b.mc;0==d.length&&i(Error("No _pointIndices defined on the X.object."));this.ba=c;this.A=3;var e=V(this,"uint");V(this,"uint");V(this,"uint");var f=0,g=0,h=0,j=0,l=0,k=0,n=0,v=0,p=0,w=0,u=0,c=Array(2),z=Array(2),C=V(this,"float",e),x;for(x=0;x<e;x++){var A=C[x];0==x&&(c[0]=z[0]=A);0<=A?(f++,j+=A):(g++,h+=A);p+=A;u++;z[0]=Math.max(A,z[0]);c[0]=Math.min(A,c[0]);C[x]=A}0!=f&&(l=j/f);0!=g&&(k=h/g);0!=u&&(w=p/u);for(u=p=h=j=0;u<e;u++)A=C[u],
x=0,0<=A?(x=Math.pow(A-l,2),j+=x):(x=Math.pow(A-k,2),h+=x),x=Math.pow(A-w,2),p+=x;1<f&&(n=Math.sqrt(j/(f-1)));1<g&&(v=Math.sqrt(h/(g-1)));c[1]=k-2.5*v;z[1]=l+2.5*n;e=d.length;f=new Float32Array(3*e);for(u=0;u<e;u++)g=C[d[u]],h=3*u,f[h]=g,f[h+1]=g,f[h+2]=g;b.t.Ka=c[1];b.t.Da=z[1];-Infinity==b.t.Q&&(b.t.Q=c[1]);Infinity==b.t.T&&(b.t.T=z[1]);b.t.u=C;b.t.Bc=f;b.t.e=o;H.Ca(this.c+".parse");d=new ud;d.da=b;d.s=a;this.dispatchEvent(d)};E("X.parserCRV",Le);E("X.parserCRV.prototype.parse",Le.prototype.parse);function Me(){Td.call(this);this.c="parserTRK"}G(Me,Td);
Me.prototype.parse=function(a,b,c){H.Ia(this.c+".parse");var d=b.g,e=b.h,f=b.Y;this.ba=c;V(this,"uchar",6);V(this,"ushort",3);var g=V(this,"float",3);V(this,"float",3);var h=V(this,"ushort");V(this,"uchar",200);V(this,"ushort");V(this,"uchar",200);V(this,"float",16);V(this,"uchar",444);V(this,"uchar",4);V(this,"uchar",4);V(this,"float",6);V(this,"uchar",2);V(this,"uchar");V(this,"uchar");V(this,"uchar");V(this,"uchar");V(this,"uchar");V(this,"uchar");var j=V(this,"uint");V(this,"uint");var l=V(this,
"uint"),k=[],n=[],c=Infinity,v=-Infinity,p=q,w=q,u=q,z=q,e=d=q,C=V(this,"uint",(this.ba.byteLength-1E3)/4);this.A=l;for(var x=V(this,"float",(this.ba.byteLength-1E3)/4),A=0,l=f=0;l<j;l++){for(var F=C[A],I=new N(3*F),S=0,O=0;O<F;O++){var P=x[A+3*O+O*h+1],ea=x[A+3*O+O*h+2],Q=x[A+3*O+O*h+3],P=P/g[0],ea=ea/g[1],Q=Q/g[2];I.add(P,ea,Q);if(0<O)var Z=I.get(O-1),S=S+Math.sqrt(Math.pow(P-Z[0],2)+Math.pow(ea-Z[1],2)+Math.pow(Q-Z[2],2));O<F-1&&(f+=6)}A+=3*F+F*h+1;O=I.Qb;F=I.Nb;P=I.Rb;ea=I.Ob;Q=I.Sb;Z=I.Pb;if(!p||
O<p)p=O;if(!w||F>w)w=F;if(!u||P<u)u=P;if(!z||ea>z)z=ea;if(!d||Q<d)d=Q;if(!e||Z>e)e=Z;k.push(I);n.push(S)}g=(p+w)/2;u=(u+z)/2;h=(d+e)/2;z=new Float32Array(f);b.g=d=new N(f);b.h=e=new N(f);b.Y=f=new N(f);for(l=p=0;l<j;l++){w=k[l];C=w.count;S=n[l];c=Math.min(c,S);v=Math.max(v,S);for(O=0;O<C-1;O++){A=w.get(O);x=w.get(O+1);d.add(A[0],A[1],A[2]);d.add(x[0],x[1],x[2]);var I=A[0]-g,F=A[1]-u,P=A[2]-h,ea=Math.sqrt(I*I+F*F+P*P),Q=x[0]-g,Z=x[1]-u,qa=x[2]-h,Ka=Math.sqrt(Q*Q+Z*Z+qa*qa);e.add(I/ea,F/ea,P/ea);e.add(Q/
Ka,Z/Ka,qa/Ka);x=[Math.abs(x[0]-A[0]),Math.abs(x[1]-A[1]),Math.abs(x[2]-A[2])];A=Math.sqrt(x[0]*x[0]+x[1]*x[1]+x[2]*x[2]);x[0]/=A;x[1]/=A;x[2]/=A;f.add(x[0],x[1],x[2]);f.add(x[0],x[1],x[2]);z[p++]=S;z[p++]=S;z[p++]=S;z[p++]=S;z[p++]=S;z[p++]=S}}b.ka="LINES";j=new td;j.Ka=c;j.Da=v;j.Q=c;j.T=v;j.Bc=z;j.Jf=r;j.e=o;b.t=j;H.Ca(this.c+".parse");c=new ud;c.da=b;c.s=a;this.dispatchEvent(c)};E("X.parserTRK",Me);E("X.parserTRK.prototype.parse",Me.prototype.parse);function Ne(){Td.call(this);this.c="parserIMAGE"}G(Ne,Td);Ne.prototype.parse=function(a,b,c,d){c instanceof ArrayBuffer||i(Error());for(var e=new Uint8Array(c),f=e.length,g=Array(f);f--;)g[f]=String.fromCharCode(e[f]);e=window.btoa(g.join(""));f=new Image;sc(f,"load",this.ui.bind(this,f,a,b,c,d));f.src="data:image/"+d+";base64,"+e};Ne.prototype.ui=function(a,b,c){b.mb=a;b.ua=q;a=new ud;a.da=c;a.s=b;this.dispatchEvent(a)};E("X.parserIMAGE",Ne);E("X.parserIMAGE.prototype.parse",Ne.prototype.parse);function Oe(){Td.call(this);this.c="parserLUT"}G(Oe,Td);
Oe.prototype.parse=function(a,b,c){H.Ia(this.c+".parse");this.ba=c;var c=V(this,"uchar",c.byteLength),d=c.length,e=0,f;for(f=0;f<d;f++)if(10==c[f]){var g=Vd(c,e,f),e=f+1,g=g.replace(/^\s+|\s+$/g,"");"#"!=g[0]&&(g=g.split(" "),g=g.filter(function(a){return""!=a}),6==g.length&&(g[2]=parseInt(g[2],10)/255,g[3]=parseInt(g[3],10)/255,g[4]=parseInt(g[4],10)/255,g[5]=parseInt(g[5],10)/255,a.add(parseInt(g[0],10),g[1],g[2],g[3],g[4],g[5],10)))}H.Ca(this.c+".parse");c=new ud;c.da=b;c.s=a;this.dispatchEvent(c)};
E("X.parserLUT",Oe);E("X.parserLUT.prototype.parse",Oe.prototype.parse);function Pe(){Td.call(this);this.c="parserNRRD"}G(Pe,Td);
Pe.prototype.parse=function(a,b,c){H.Ia(this.c+".parse");this.ba=c;var c=V(this,"uchar",c.byteLength),d=c.length,e=q,f=0,g;for(g=1;g<d;g++)if(10==c[g-1]&&10==c[g]){e=Vd(c,0,g-2);f=g+1;break}var h,j,l,k,d=e.split(/\r?\n/);for(e=0,g=d.length;e<g;e++)if(h=d[e],h.match(/NRRD\d+/))this.Oh=o;else if(!h.match(/^#/)&&(k=h.match(/(.*):(.*)/)))j=k[1].trim(),h=k[2].trim(),(l=this.th[j])?l.call(this,h):this[j]=h;this.Oh||i(Error("Not an NRRD file"));"raw"!==this.encoding&&"gzip"!==this.encoding&&"gz"!==this.encoding&&
i(Error("Only raw or gz/gzip encoding is allowed"));if(!this.Ha&&(this.Ha=[new M(1,0,0),new M(0,1,0),new M(0,0,1)],this.lf)){d=[];for(k=0;2>=k;k++)d.push(!isNaN(this.lf[k])?this.Ha[k].scale(this.lf[k]):m)}f=c.subarray(f);if("gzip"==this.encoding||"gz"==this.encoding)f=(new Fe(f)).pf();f=f.buffer;c={data:q,min:Infinity,max:-Infinity};c.data=new this.Gb(f);k=Ud(c.data);f=c.min=k[0];k=c.max=k[1];b.ca=[this.hf[0],this.hf[1],this.hf[2]];b.H=[(new M(this.Ha[0][0],this.Ha[0][1],this.Ha[0][2])).cc(),(new M(this.Ha[1][0],
this.Ha[1][1],this.Ha[1][2])).cc(),(new M(this.Ha[2][0],this.Ha[2][1],this.Ha[2][2])).cc()];b.Ka=b.V=f;b.Da=b.U=k;-Infinity==b.Q&&(b.Q=f);Infinity==b.T&&(b.T=k);b.pc();H.Ca(this.c+".parse");b.mb=Wd(this,b,c);c=new ud;c.da=b;c.s=a;this.dispatchEvent(c)};
Pe.prototype.th={type:function(a){switch(a){case "uchar":case "unsigned char":case "uint8":case "uint8_t":this.Gb=Uint8Array;break;case "signed char":case "int8":case "int8_t":this.Gb=Int8Array;break;case "short":case "short int":case "signed short":case "signed short int":case "int16":case "int16_t":this.Gb=Int16Array;break;case "ushort":case "unsigned short":case "unsigned short int":case "uint16":case "uint16_t":this.Gb=Uint16Array;break;case "int":case "signed int":case "int32":case "int32_t":this.Gb=
Int32Array;break;case "uint":case "unsigned int":case "uint32":case "uint32_t":this.Gb=Uint32Array;break;case "float":this.Gb=Float32Array;break;default:i(Error("Unsupported NRRD data type: "+a))}return this.type=a},endian:function(a){return a},encoding:function(a){return this.encoding=a},dimension:function(a){return this.va=parseInt(a,10)},sizes:function(a){var b,c,d,e;d=a.split(/\s+/);e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(parseInt(a,10));return this.hf=e},"space directions":function(a){var b,
c,d;c=a.match(/\(.*?\)/g);return this.Ha=function(){var a,f,g;g=[];for(a=0,f=c.length;a<f;a++)d=c[a],g.push(function(){var a,c,e,f;e=d.slice(1,-1).split(/,/);f=[];for(a=0,c=e.length;a<c;a++)b=e[a],f.push(parseFloat(b));return f}());return g}()},spacings:function(a){var b;b=a.split(/\s+/);var c,d,e;e=[];for(c=0,d=b.length;c<d;c++)a=b[c],e.push(parseFloat(a));return this.lf=e}};E("X.parserNRRD",Pe);E("X.parserNRRD.prototype.parse",Pe.prototype.parse);function Qe(){Td.call(this);this.c="parserNII"}G(Qe,Td);
Qe.prototype.parse=function(a,b,c){H.Ia(this.c+".parse");var d=c,e=-1,e="undefined"==typeof DataView?(new Int32Array(c,0,1))[0]:(new DataView(c,0)).getInt32(0,o);348!=e&&(d=(new Fe(new Uint8Array(c))).pf(),d=d.buffer);c=this.ed(d);b.ca=[c.va[1],c.va[2],c.va[3]];b.H=[c.la[1],c.la[2],c.la[3]];d=c.min;e=c.max;b.Ka=b.V=d;b.Da=b.U=e;-Infinity==b.Q&&(b.Q=d);Infinity==b.T&&(b.T=e);b.pc();H.Ca(this.c+".parse");b.mb=Wd(this,b,c);c=new ud;c.da=b;c.s=a;this.dispatchEvent(c)};
Qe.prototype.ed=function(a){this.ba=a;a={Ri:0,kh:q,lh:q,sh:0,Li:0,Di:0,oh:q,va:q,Jh:0,Kh:0,Lh:0,Hh:0,Ke:0,fh:0,Vi:0,la:q,Lg:0,Ki:0,Ji:0,Ui:0,Si:q,jj:q,hh:0,ih:0,Ti:0,cj:0,zh:0,Ah:0,nh:q,eh:q,wi:0,Pi:0,Ai:0,Bi:0,Ci:0,xi:0,yi:0,zi:0,Xi:q,Yi:q,Zi:q,Ih:q,Ph:q,data:q,min:Infinity,max:-Infinity};a.Ri=V(this,"uint");a.kh=V(this,"uchar",10);a.lh=V(this,"uchar",18);a.sh=V(this,"uint");a.Li=V(this,"ushort");a.Di=V(this,"uchar");a.oh=V(this,"uchar");a.va=V(this,"ushort",8);a.Jh=V(this,"float");a.Kh=V(this,"float");
a.Lh=V(this,"float");a.Hh=V(this,"ushort");a.Ke=V(this,"ushort");a.fh=V(this,"ushort");a.Vi=V(this,"ushort");a.la=V(this,"float",8);a.Lg=V(this,"float");a.Ki=V(this,"float");a.Ji=V(this,"float");a.Ui=V(this,"ushort");a.Si=V(this,"uchar");a.jj=V(this,"uchar");a.hh=V(this,"float");a.ih=V(this,"float");a.Ti=V(this,"float");a.cj=V(this,"float");a.zh=V(this,"uint",1);a.Ah=V(this,"uint",1);a.nh=V(this,"uchar",80);a.eh=V(this,"uchar",24);a.wi=V(this,"ushort");a.Pi=V(this,"ushort");a.Ai=V(this,"float");a.Bi=
V(this,"float");a.Ci=V(this,"float");a.xi=V(this,"float");a.yi=V(this,"float");a.zi=V(this,"float");a.Xi=V(this,"float",4);a.Yi=V(this,"float",4);a.Zi=V(this,"float",4);a.Ih=V(this,"uchar",16);a.Ph=V(this,"uchar",4);this.A=parseInt(a.Lg,10);var b=a.va[1]*a.va[2]*a.va[3];switch(a.Ke){case 2:a.data=V(this,"uchar",b);break;case 4:a.data=V(this,"sshort",b);break;case 8:a.data=V(this,"sint",b);break;case 16:a.data=V(this,"float",b);break;case 256:a.data=V(this,"schar",b);break;case 512:a.data=V(this,"ushort",
b);break;case 768:a.data=V(this,"uint",b);break;default:i(Error("Unsupported NII data type: "+a.Ke))}b=Ud(a.data);a.min=b[0];a.max=b[1];return a};E("X.parserNII",Qe);E("X.parserNII.prototype.parse",Qe.prototype.parse);function Re(){K.call(this);this.c="loader";this.kc=new Ob;this.Oc=0}G(Re,K);function Se(a,b){a.Oc+=b/a.kc.Za()/3;a.Oc=Math.min(1,a.Oc);var c=new Sd;c.Lf=a.Oc;a.dispatchEvent(c)}function Te(a){var a=a.p.wd,b=a.split(".").pop().toUpperCase();b==a.toUpperCase()&&(b="");b in Ue||i(Error("The "+b+" file format is not supported."));return[a,b,Ue[b][0],Ue[b][1],Ue[b][2]]}
Re.prototype.load=function(a,b){(!a||!b)&&i(Error("No container or object to load."));if(!Qb(this.kc.D,a.ra)||this.kc.get(a.ra)){this.kc.set(a.ra,r);var c=Te(a)[0];if(a.Jb!=q)this.parse(q,a,b);else{var d=new XMLHttpRequest;J(d,"abort",this.Xf.bind(this,d,a,b));J(d,"error",this.Xf.bind(this,d,a,b));J(d,"load",this.parse.bind(this,d,a,b));d.open("GET",c,o);d.responseType="arraybuffer";d.send(q)}}};
Re.prototype.parse=function(a,b,c){Se(this,1);setTimeout(function(){var d=Te(b),e=d[3],d=new d[2];sc(d,yc,this.complete.bind(this));var f=b.Jb;f==q&&(f=a.response);d.parse(b,c,f,e)}.bind(this),100)};Re.prototype.complete=function(a){Se(this,1);setTimeout(function(){var b=a.s,c=a.da;b.p.e=r;b.e=o;c.o();this.kc.set(b.ra,o)}.bind(this),100)};Re.prototype.Xf=function(a,b,c){i(Error("Loading failed: ",b,c))};
var Ue={STL:[Ee,q],VTK:[He,q],TRK:[Me,q],FSM:[Je,q],INFLATED:[Je,q],SMOOTHWM:[Je,q],SPHERE:[Je,q],PIAL:[Je,q],ORIG:[Je,q],NRRD:[Pe,q],NII:[Qe,q],GZ:[Qe,q],DCM:[Ge,q],DICOM:[Ge,q],"":[Ge,q],CRV:[Le,q],LABEL:[be,q],MGH:[Ke,r],MGZ:[Ke,o],TXT:[Oe,q],LUT:[Oe,q],PNG:[Ne,"png"],JPG:[Ne,"jpeg"],JPEG:[Ne,"jpeg"],GIF:[Ne,"gif"]};function Ve(a,b){(!D(a)||!D(b))&&i(Error("A camera needs valid width and height values."));K.call(this);this.c="camera";this.ta=new M(0,0,100);this.ic=new M(0,0,0);this.I=new M(0,1,0);this.m=this.Wd(this.ta,this.ic);this.Lb=new Float32Array(this.m.Fa())}G(Ve,K);Ve.prototype.hi=function(a){a instanceof Md||i(Error("Received no valid rotate event."));this.rotate(a.K)};Ve.prototype.ti=function(a){a instanceof Nd||i(Error("Received no valid zoom event."));a.Wa?this.Mg(a.Ja):this.Ng(a.Ja)};
Ve.prototype.ei=function(a){a instanceof Ld||i(Error("Received no valid pan event."));this.xg(a.K)};Ve.prototype.__defineGetter__("view",s("m"));Ve.prototype.__defineSetter__("view",function(a){(!y(a)||!(a instanceof id))&&i(Error("Invalid view matrix."));this.m=a;this.Lb=new Float32Array(this.m.Fa())});Ve.prototype.__defineGetter__("position",function(){return[this.ta.x,this.ta.y,this.ta.b]});
Ve.prototype.__defineSetter__("position",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid position."));this.ta=new M(a[0],a[1],a[2]);this.reset()});Ve.prototype.__defineGetter__("focus",function(){return[this.ic.x,this.ic.y,this.ic.b]});Ve.prototype.__defineSetter__("focus",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid focus"));this.ic=new M(a[0],a[1],a[2]);this.reset()});Ve.prototype.__defineGetter__("up",function(){return[this.I.x,this.I.y,this.I.b]});
Ve.prototype.__defineSetter__("up",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid up vector."));this.I=new M(a[0],a[1],a[2]);this.reset()});t=Ve.prototype;t.reset=function(){this.m=this.Wd(this.ta,this.ic);this.Lb=new Float32Array(this.m.Fa())};t.rotate=function(a){B(a)&&2==a.length?a=new Xc(a[0],a[1]):a instanceof Xc||i(Error("Invalid distance vector for rotate operation."));return a};
t.xg=function(a){B(a)&&2==a.length?a=new Xc(a[0],a[1]):a instanceof Xc||i(Error("Invalid distance vector for pan operation."));a=new M(-a.x,a.y,0);a=jd(4).translate(a);this.m=new id(a.multiply(this.m));this.Lb=new Float32Array(this.m.Fa())};t.Mg=function(a){var b=20;y(a)&&!a&&(b=1);a=new M(0,0,b);a=jd(4).translate(a);this.m=new id(a.multiply(this.m));this.Lb=new Float32Array(this.m.Fa())};
t.Ng=function(a){var b=30;y(a)&&!a&&(b=1);a=new M(0,0,-b);a=jd(4).translate(a);this.m=new id(a.multiply(this.m));this.Lb=new Float32Array(this.m.Fa())};t.Wd=function(a,b){(!(a instanceof M)||!(b instanceof M))&&i(Error("3D vectors required for calculating the view."));return jd(4)};E("X.camera",Ve);E("X.camera.prototype.pan",Ve.prototype.xg);E("X.camera.prototype.rotate",Ve.prototype.rotate);E("X.camera.prototype.zoomIn",Ve.prototype.Mg);E("X.camera.prototype.zoomOut",Ve.prototype.Ng);function We(a){function b(a,b,d){b=2*b*Math.PI;b=j.Fb(Math.cos(b)).uc(l.Fb(Math.sin(b)));a=c.uc(e.Fb(a)).uc(b.Fb(f));d=b.Fb(1-Math.abs(d)).uc(g.Fb(d));return new Ec(a,d)}this.z=[];for(var a=a||{},c=new ua(a.start||[0,-1,0]),d=new ua(a.end||[0,1,0]),e=d.cd(c),f=a.ab||1,a=a.jf||16,g=e.kd(),h=0.5<Math.abs(g.y()),j=(new ua(h,!h,0)).Ie(g).kd(),l=j.Ie(g).kd(),h=new Ec(c,g.Ye()),d=new Ec(d,g.kd()),k=[],n=0;n<a;n++){var v=n/a,p=(n+1)/a;k.push(new Jc([h,b(0,v,-1),b(0,p,-1)]));k.push(new Jc([b(0,p,0),b(0,v,
0),b(1,v,0),b(1,p,0)]));k.push(new Jc([d,b(1,p,1),b(1,v,1)]))}return Mc(k)}G(We,Lc);function Xe(){R.call(this);this.c="cylinder";this.ye=[-10,-10,-10];this.fe=[10,10,10];this.Tb=10;this.Wb=32;va(this,new wd)}G(Xe,R);Xe.prototype.__defineGetter__("start",s("ye"));Xe.prototype.__defineSetter__("start",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid start"));this.ye=a});Xe.prototype.__defineGetter__("end",s("fe"));Xe.prototype.__defineSetter__("end",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid end"));this.fe=a});Xe.prototype.__defineGetter__("radius",s("Tb"));
Xe.prototype.__defineSetter__("radius",function(a){D(a)||i(Error("Invalid radius."));this.Tb=a});Xe.prototype.o=function(){yd(this,new We({start:this.ye,end:this.fe,ab:this.Tb,jf:this.Wb}));Xe.j.o.call(this)};E("X.cylinder",Xe);E("X.cylinder.prototype.modified",Xe.prototype.o);function Ye(a){function b(a,b){var a=a*2*Math.PI,b=b*Math.PI,e=new ua(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new Ec(c.uc(e.Fb(d)),e))}this.z=[];for(var a=a||{},c=new ua(a.Ee||[0,0,0]),d=a.ab||1,e=a.jf||16,a=a.$i||8,f=[],g=[],h=0;h<e;h++)for(var j=0;j<a;j++)g=[],b(h/e,j/a),0<j&&b((h+1)/e,j/a),j<a-1&&b((h+1)/e,(j+1)/a),b(h/e,(j+1)/a),f.push(new Jc(g));return Mc(f)}G(Ye,Lc);function Ze(){R.call(this);this.c="sphere";this.l=[0,0,0];this.Tb=5;this.Wb=32;this.Zg=16;va(this,new wd)}G(Ze,R);Ze.prototype.__defineGetter__("center",s("l"));Ze.prototype.__defineSetter__("center",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid center"));this.l=a});Ze.prototype.__defineGetter__("radius",s("Tb"));Ze.prototype.__defineSetter__("radius",function(a){D(a)||i(Error("Invalid radius."));this.Tb=a});
Ze.prototype.o=function(){yd(this,new Ye({Ee:this.l,ab:this.Tb,jf:this.Wb,$i:this.Zg}));Ze.j.o.call(this)};E("X.sphere",Ze);E("X.sphere.prototype.modified",Ze.prototype.o);function De(a){L.call(this);this.c="labelmap";this.ib=a}G(De,L);De.prototype.o=function(){var a=new ud;a.da=this;this.dispatchEvent(a);this.ib.o()};E("X.labelmap",De);function $e(a){this.z=[];var a=a||{},b=new ua(a.Ee||[0,0,0]),c=!a.ab?[1,1,1]:a.ab.length?a.ab:[a.ab,a.ab,a.ab];return Mc([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new Jc(a[0].map(function(e){e=new ua(b.x()+c[0]*(2*!!(e&1)-1),b.y()+c[1]*(2*!!(e&2)-1),b.b()+c[2]*(2*!!(e&4)-1));return new Ec(e,new ua(a[1]))}))}))}G($e,Lc);function af(){R.call(this);this.c="cube";this.l=[0,0,0];this.me=this.le=this.ke=20;this.Xb=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];va(this,new wd)}G(af,R);af.prototype.__defineGetter__("center",s("l"));af.prototype.__defineSetter__("center",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid center"));this.l=a});af.prototype.__defineGetter__("lengthX",s("ke"));
af.prototype.__defineSetter__("lengthX",function(a){D(a)||i(Error("Invalid lengthX."));this.ke=a});af.prototype.__defineGetter__("lengthY",s("le"));af.prototype.__defineSetter__("lengthY",function(a){D(a)||i(Error("Invalid lengthY."));this.le=a});af.prototype.__defineGetter__("lengthZ",s("me"));af.prototype.__defineSetter__("lengthZ",function(a){D(a)||i(Error("Invalid lengthZ."));this.me=a});af.prototype.o=function(){yd(this,new $e({Ee:this.l,ab:[this.ke/2,this.le/2,this.me/2]}));af.j.o.call(this)};
E("X.cube",af);E("X.cube.prototype.modified",af.prototype.o);function ye(a){W.call(this,a);this.c="interactor3D"}G(ye,W);ye.prototype.dd=function(a){ye.j.dd.call(this,a);var b=new Nd;y(a.qc)||(a.qc=0);b.Wa=0>a.qc;b.Ja=o;this.dispatchEvent(b)};function bf(a){K.call(this);this.c="array";this.u=[];this.uf=a}G(bf,K);bf.prototype.add=function(a){this.u.push(a);return o};bf.prototype.clear=function(){this.u.length=0};function cf(a,b,c){var d=c-b;if(!(2>d)){d=b+Math.floor(d/2);cf(a,b,d);for(cf(a,d,c);b<d;++b)if(0<a.uf(a.u[b],a.u[d])){var e=a.u[b];a.u[b]=a.u[d];for(var f=a,g=d,h=c;g+1<h&&0>f.uf(f.u[g+1],e);){var j=f,l=g+1,k=j.u[g];j.u[g]=j.u[l];j.u[l]=k;++g}f.u[g]=e}}}bf.prototype.sort=function(){cf(this,0,this.u.length)};function df(a,b){Ve.call(this,a,b);this.c="camera2D"}G(df,Ve);df.prototype.rotate=function(a){var a=df.j.rotate.call(this,a),b=new Kd;0<a.x?b.Ae--:0>a.x&&b.Ae++;0<a.y?b.ne++:0>a.y&&b.ne--;this.dispatchEvent(b)};function ef(a,b){Ve.call(this,a,b);this.c="camera3D";this.wf=45;this.Gf=new Float32Array(ff(this.wf,a/b).Fa())}G(ef,Ve);function ff(a,b){var c=1*Math.tan(a*Math.PI/360),d=-c;return new id([[2/(c*b-d*b),0,(c*b+d*b)/(c*b-d*b),0],[0,2/(c-d),(c+d)/(c-d),0],[0,0,-10001/9999,-2.000200020002],[0,0,-1,0]])}
ef.prototype.rotate=function(a){var a=ef.j.rotate.call(this,a),b=-a.x/5*Math.PI/180,a=-a.y/5*Math.PI/180,c=jd(4),d=new M(parseFloat(this.m.X(0,0)),parseFloat(this.m.X(0,1)),parseFloat(this.m.X(0,2))),b=c.rotate(b,new M(parseFloat(this.m.X(1,0)),parseFloat(this.m.X(1,1)),parseFloat(this.m.X(1,2)))),a=c.rotate(a,d);this.m=new id(this.m.multiply(a.multiply(b)));this.Lb=new Float32Array(this.m.Fa())};
ef.prototype.Wd=function(a,b){ef.j.Wd.call(this,a,b);var c=jd(4),d=new M(a.x-b.x,a.y-b.y,a.b-b.b),d=d.normalize(),e=this.I.f();e.Vc(d)&&(e.b+=1.0E-6);var f=Uc(e,d),e=Uc(d,f),f=f.normalize(),e=e.normalize();c.k(0,0,f.x);c.k(0,1,f.y);c.k(0,2,f.b);c.k(0,3,0);c.k(1,0,e.x);c.k(1,1,e.y);c.k(1,2,e.b);c.k(1,3,0);c.k(2,0,d.x);c.k(2,1,d.y);c.k(2,2,d.b);c.k(2,3,0);c.k(3,0,0);c.k(3,1,0);c.k(3,2,0);c.k(3,3,1);d=a.f();return c.translate(d.$())};E("X.camera3D",ef);function gf(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}gf.prototype.f=function(){return new gf(this.top,this.right,this.bottom,this.left)};gf.prototype.contains=function(a){return!this||!a?r:a instanceof gf?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};function hf(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}hf.prototype.f=function(){return new hf(this.left,this.top,this.width,this.height)};hf.prototype.fg=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top),a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,o}return r};
hf.prototype.contains=function(a){return a instanceof hf?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};hf.prototype.wa=function(){return new Zc(this.width,this.height)};function jf(a,b){var c=je(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,q))?c[b]||c.getPropertyValue(b):""}function kf(a,b){return a.currentStyle?a.currentStyle[b]:q}function lf(a,b){return jf(a,b)||kf(a,b)||a.style&&a.style[b]}function mf(a){a=a?9==a.nodeType?a:je(a):document;return Ua&&!mb(9)&&!ve(he(a))?a.body:a.documentElement}
function nf(a){var b=a.getBoundingClientRect();Ua&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function of(a){if(Ua&&!mb(8))return a.offsetParent;for(var b=je(a),c=lf(a,"position"),d="fixed"==c||"absolute"==c,a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=lf(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return q}
function pf(a){for(var b=new gf(0,Infinity,Infinity,0),c=he(a),d=c.P.body,e=c.P.documentElement,f=!Wa&&"CSS1Compat"==c.P.compatMode?c.P.documentElement:c.P.body;a=of(a);)if((!Ua||0!=a.clientWidth)&&(!Wa||0!=a.clientHeight||a!=d)&&a!=d&&a!=e&&"visible"!=lf(a,"overflow")){var g=qf(a),h;h=a;if(Va&&!kb("1.9")){var j=parseFloat(jf(h,"borderLeftWidth"));if(rf(h))var l=h.offsetWidth-h.clientWidth-j-parseFloat(jf(h,"borderRightWidth")),j=j+l;h=new Vc(j,parseFloat(jf(h,"borderTopWidth")))}else h=new Vc(h.clientLeft,
h.clientTop);g.x+=h.x;g.y+=h.y;b.top=Math.max(b.top,g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=c.P.parentWindow||c.P.defaultView||window;e=c.document;Wa&&!kb("500")&&!Xa?("undefined"==typeof c.innerHeight&&(c=window),e=c.innerHeight,a=c.document.documentElement.scrollHeight,c==c.top&&a<e&&(e-=15),c=new Zc(c.innerWidth,e)):(c="CSS1Compat"==
e.compatMode?e.documentElement:e.body,c=new Zc(c.clientWidth,c.clientHeight));b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:q}
function qf(a){var b,c=je(a),d=lf(a,"position"),e=Va&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Vc(0,0),g=mf(c);if(a==g)return f;if(a.getBoundingClientRect)b=nf(a),a=we(he(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);
if(Wa&&"fixed"==lf(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Sa||Wa&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=of(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!Sa||"TR"!=b.tagName)f.y-=b.scrollTop}return f}function sf(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function tf(a){if("none"!=lf(a,"display"))return uf(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=uf(a);b.display=c;b.position=e;b.visibility=d;return a}function uf(a){var b=a.offsetWidth,c=a.offsetHeight,d=Wa&&!b&&!c;return(!ga(b)||d)&&a.getBoundingClientRect?(a=nf(a),new Zc(a.right-a.left,a.bottom-a.top)):new Zc(b,c)}function vf(a,b){a.style.display=b?"":"none"}function rf(a){return"rtl"==lf(a,"direction")}
function wf(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}var xf={thin:2,medium:4,thick:6};function yf(a,b){if("none"==kf(a,b+"Style"))return 0;var c=kf(a,b+"Width");return c in xf?xf[c]:wf(a,c)};function zf(a){this.Qa=a;this.v=[]}G(zf,Vb);var Af=[];function Bf(a,b,c,d,e){B(c)||(Af[0]=c,c=Af);for(var f=0;f<c.length;f++)a.v.push(J(b,c[f],d||a,e||r,a.Qa||a))}zf.prototype.Zd=function(){wb(this.v,uc);this.v.length=0};zf.prototype.O=function(){zf.j.O.call(this);this.Zd()};zf.prototype.handleEvent=function(){i(Error("EventHandler.handleEvent not implemented"))};function Cf(){}(function(a){a.Yf=function(){return a.Gh||(a.Gh=new a)}})(Cf);Cf.prototype.Ze=0;Cf.Yf();function Df(a){this.Ya=a||he()}G(Df,Dc);t=Df.prototype;t.Eh=Cf.Yf();t.eg=q;t.bc=r;t.q=q;t.tc=q;t.Jd=q;t.Tc=q;t.ij=r;t.i=s("q");t.gf=function(a){this.tc&&this.tc!=a&&i(Error("Method not supported"));Df.j.gf.call(this,a)};t.Nd=s("Ya");t.oc=function(){this.q=this.Ya.createElement("div")};t.ec=function(a){this.Eb(a)};t.Eb=function(a,b){this.bc&&i(Error("Component already rendered"));this.q||this.oc();a?a.insertBefore(this.q,b||q):this.Ya.P.body.appendChild(this.q);(!this.tc||this.tc.bc)&&this.Md()};
t.Md=function(){this.bc=o;Ef(this,function(a){!a.bc&&a.i()&&a.Md()})};t.Xc=function(){Ef(this,function(a){a.bc&&a.Xc()});this.Rd&&this.Rd.Zd();this.bc=r};t.O=function(){Df.j.O.call(this);this.bc&&this.Xc();this.Rd&&(this.Rd.Oa(),delete this.Rd);Ef(this,function(a){a.Oa()});!this.ij&&this.q&&se(this.q);this.tc=this.q=this.Tc=this.Jd=q};function Ef(a,b){a.Jd&&wb(a.Jd,b,m)}
t.removeChild=function(a,b){if(a){var c=ia(a)?a:a.eg||(a.eg=":"+(a.Eh.Ze++).toString(36)),a=this.Tc&&c?(c in this.Tc?this.Tc[c]:m)||q:q;if(c&&a){var d=this.Tc;c in d&&delete d[c];Ab(this.Jd,a);b&&(a.Xc(),a.q&&se(a.q));c=a;c==q&&i(Error("Unable to set parent component"));c.tc=q;Df.j.gf.call(c,q)}}a||i(Error("Child is not in parent component"));return a};function Ff(){}G(Ff,Dc);t=Ff.prototype;t.qf=0;t.bd=0;t.Ue=100;t.Wf=0;t.mf=1;t.Nh=r;t.Rh=r;t.be=function(a){a=Gf(this,a);this.qf!=a&&(this.qf=a+this.Wf>this.Ue?this.Ue-this.Wf:a<this.bd?this.bd:a,!this.Nh&&!this.Rh&&this.dispatchEvent("change"))};t.Qd=function(){return Gf(this,this.qf)};t.Pd=function(){return Gf(this,this.bd)};t.Od=function(){return Gf(this,this.Ue)};function Gf(a,b){return a.mf==q?b:a.bd+Math.round((b-a.bd)/a.mf)*a.mf};function Hf(a){this.Ya=a||he();this.vc=new Ff;J(this.vc,"change",this.Bh,r,this)}G(Hf,Df);var If={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};t=Hf.prototype;t.oc=function(){this.Ua=this.Nd().oc("div","progress-bar-thumb");var a=If[this.wg];this.q=this.Nd().oc("div",a,this.Ua);Jf(this);this.i().setAttribute("aria-valuemin",this.Pd());this.i().setAttribute("aria-valuemax",this.Od())};
t.Md=function(){Hf.j.Md.call(this);Ua&&7>ab&&J(this.i(),"resize",this.de,r,this);this.de();var a=this.i();a.setAttribute("role","progressbar");a.bk="progressbar";this.i().setAttribute("aria-live","polite")};t.Xc=function(){Hf.j.Xc.call(this);Kf(this)};function Kf(a){Ua&&7>ab&&tc(a.i(),"resize",a.de,r,a)}t.Qd=function(){return this.vc.Qd()};t.be=function(a){this.vc.be(a);this.i()&&Jf(this)};function Jf(a){var b=a.Qd();a.i().setAttribute("aria-valuenow",b)}t.Pd=function(){return this.vc.Pd()};
t.Od=function(){return this.vc.Od()};t.wg="horizontal";t.Bh=function(){this.de();this.dispatchEvent("change")};t.de=function(){if(this.Ua){var a=this.Pd(),b=this.Od(),a=(this.Qd()-a)/(b-a),b=Math.round(100*a);"vertical"==this.wg?Ua&&7>ab?(this.Ua.style.top=0,this.Ua.style.height="100%",b=this.Ua.offsetHeight,a=Math.round(a*b),this.Ua.style.top=b-a+"px",this.Ua.style.height=a+"px"):(this.Ua.style.top=100-b+"%",this.Ua.style.height=b+"%"):this.Ua.style.width=b+"%"}};
t.O=function(){Kf(this);Hf.j.O.call(this);this.Ua=q;this.vc.Oa()};function Lf(a,b){y(a)||i(Error("No valid parent element."));y(b)||i(Error("Invalid initial value."));Hf.call(this);this.c="progressbar";this.ma=a;this.Ff="";this.pd=this.hb=q;this.Ib=[];this.Ib=[".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n  background: white;\n  padding: 1px;\n  overflow: hidden;\n  margin: 2px;\n  width: 100px;\n  height: 5px;\n}",".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n  overflow: hidden;\n  width: 0%;\n  height: 100%;\n}",
".progress-bar-thumb-done {\n  background: #57E964;\n}"];this.be(b);this.Qe()}G(Lf,Hf);
Lf.prototype.Qe=function(){if("static"==this.ma.style.position||""==this.ma.style.position)this.Ff=this.ma.style.position,this.ma.style.position="relative";var a=document.getElementsByTagName("head")[0],b=ne("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.Ib[0]),d=document.createTextNode(this.Ib[1]),e=document.createTextNode(this.Ib[2]);a.appendChild(b);b.appendChild(c);b.appendChild(d);b.appendChild(e);this.hb=b;this.ec(this.ma);a=this.i();a.style.position="absolute";
a.style.top=(this.ma.clientHeight-5)/2+"px";a.style.left=(this.ma.clientWidth-100)/2+"px";a.classList.add("xtk-progress-bar")};function Mf(a){var b=a.i().style.top,c=a.i().style.left;se(a.i());var d=new Lf(a.ma,100),e=d.i();e.style.position="absolute";e.style.top=b;e.style.left=c;e.classList.add("xtk-progress-bar");(e.firstElementChild!=m?e.firstElementChild:te(e.firstChild)).classList.add("progress-bar-thumb-done");a.pd=d}
Lf.prototype.Td=function(){this.hb&&se(this.hb);this.i()&&se(this.i());this.pd&&se(this.pd.i());this.pd=this.hb=q;this.ma.style.position=this.Ff};var Nf=ca.window;function Of(a,b,c){ja(a)?c&&(a=ra(a,c)):a&&"function"==typeof a.handleEvent?a=ra(a.handleEvent,a):i(Error("Invalid listener argument"));return 2147483647<b?-1:Nf.setTimeout(a,b||0)};function Pf(){K.call(this);this.c="renderer";this.s=window.document.body;this.M=this.s.clientWidth;this.G=this.s.clientHeight;this.Mb=this.r=this.ia=q;this.fb=new bf(vd);this.Xa=[];this.B=q;this.se=this.td=this.ud=r;this.a=this.na=q;this.J={PROGRESSBAR_ENABLED:o};this.sf=-1;window.console.log("XTK release 9 -- 2012-11-09 12:43:04 -- http://www.goXTK.com -- @goXTK")}G(Pf,K);t=Pf.prototype;t.fi=function(a){this.na&&this.na.be(100*a.Lf)};t.Wh=function(a){y(a)&&a instanceof ud&&a.da&&this.bb(a.da)};
t.bf=function(a){(!y(a)||!(a instanceof Pd))&&i(Error("Invalid hover event."))};t.gi=function(){var a=ke(this.s);this.M=a.clientWidth;this.G=a.clientHeight;a=ke(this.ia);a.width=this.M;a.height=this.G;"renderer3D"==this.c&&(this.a.viewport(0,0,this.M,this.G),this.r.Gf=new Float32Array(ff(this.r.wf,this.ia.width/this.ia.height).Fa()));this.xc()};t.cf=function(a){(!y(a)||!(a instanceof Od))&&i(Error("Invalid scroll event."))};Pf.prototype.__defineGetter__("config",s("J"));
Pf.prototype.__defineGetter__("interactor",s("Mb"));Pf.prototype.__defineGetter__("camera",s("r"));Pf.prototype.__defineGetter__("loadingCompleted",s("td"));Pf.prototype.__defineGetter__("container",s("s"));Pf.prototype.__defineSetter__("container",function(a){y(a)||i(Error("An ID to a valid container (<div>..) is required."));var b=a;ia(b)&&(b=ke(a));ka(b)&&1==b.nodeType||i(Error("Could not find the given container."));this.s=b});t=Pf.prototype;t.xc=function(){this.r.reset()};
function Qf(a){a.J.PROGRESSBAR_ENABLED&&a.na&&!a.tf&&(Mf(a.na),a.tf=Of(function(){this.tf=q;this.na&&(this.na.Td(),this.na=q);this.ec()}.bind(a),700))}
t.ha=function(a){var b=ne("canvas");this.s.appendChild(b);this.M=this.s.clientWidth;this.G=this.s.clientHeight;b.width=this.M;b.height=this.G;try{var c=b.getContext(a);c||i(Error())}catch(d){var e="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..';this.s.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+e+"</p>";
i(Error(e))}this.B=new Re;J(this.B,Gd,this.fi.bind(this));this.ia=b;this.a=c;b=new ye(this.ia);"2d"==a&&(b=new Ae(this.ia));b.ha();J(b,Ed,this.xc.bind(this));J(b,Hd,this.bf.bind(this));J(b,Dd,this.cf.bind(this));this.Mb=b;b=new ef(this.M,this.G);"2d"==a&&(b=new df(this.M,this.G));a=b;c=this.Mb;(!y(c)||!(c instanceof W))&&i(Error("Could not observe the interactor."));J(c,Bd,a.hi.bind(a));J(c,Ad,a.ei.bind(a));J(c,Cd,a.ti.bind(a));this.r=b;J(window,"resize",this.gi,r,this)};
t.add=function(a){(a instanceof af||a instanceof Ze||a instanceof Xe)&&a.o();this.Xa.push(a);this.bb(a)};t.bb=function(a){(!this.ia||!this.a)&&i(Error("The renderer was not initialized properly."));y(a)||(window.console.log(a),i(Error("Illegal object.")));xc(a)||J(a,yc,this.Wh.bind(this))};t.get=function(a){y(a)||i(Error("Invalid object id."));for(var b=this.fb.u,c=b.length,d=0,d=0;d<c;d++)if(b[d].ra==a)return b[d];return q};
t.ec=function(){(!this.ia||!this.a)&&i(Error("The renderer was not initialized properly."));y(this.If)||(this.B.kc.Ge(r)?(this.J.PROGRESSBAR_ENABLED&&!this.na&&(this.na=new Lf(this.s,3)),this.se=this.td=r,this.If=Of(function(){this.If=q;this.ec()}.bind(this),100)):(!this.td&&!this.se&&(this.se=o,eval("this.onShowtime()"),this.td=o),this.na?Qf(this):(this.sf=window.fd(this.ec.bind(this),this.ia),eval("this.onRender()"),this.Eb(r,o))))};t.vg=aa();t.tg=aa();t.Eb=aa();
t.Ld=function(){window.Id(this.sf);this.B&&(delete this.B,this.B=q);this.na&&(this.na.Td(),delete this.na,this.na=q);this.fb.clear();delete this.fb;this.Xa.length=0;delete this.Xa;delete this.B;this.B=q;delete this.r;this.r=q;delete this.Mb;this.Mb=q;delete this.a;this.a=q;se(this.ia);delete this.ia;this.ia=q};function Rf(){K.call(this);this.c="shaders";this.Cd="";this.Cd="precision mediump float;\n\nattribute vec3 vertexPosition;\nattribute vec3 vertexNormal;\nattribute vec3 vertexColor;\nattribute vec2 vertexTexturePos;\nattribute float vertexScalar;\n\nuniform mat4 view;\nuniform mat4 perspective;\nuniform vec3 center;\nuniform mat4 objectTransform;\nuniform bool useObjectColor;\nuniform bool useScalars;\nuniform bool scalarsReplaceMode;\nuniform float scalarsMin;\nuniform float scalarsMax;\nuniform vec3 scalarsMinColor;\nuniform vec3 scalarsMaxColor;\nuniform float scalarsMinThreshold;\nuniform float scalarsMaxThreshold;\nuniform int scalarsInterpolation;\nuniform vec3 objectColor;\nuniform float pointSize;\n\nvarying float fDiscardNow;\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fVertexNormal;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * vertexNormal;\n  fVertexNormal = vertexNormal;\n  fDiscardNow = 0.0;\n  vec3 vertexPosition2 = vertexPosition - center;\n  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n  fragmentTexturePos = vertexTexturePos;\n  if (useScalars) {\n    float scalarValue = vertexScalar;\n    if (scalarValue < scalarsMinThreshold || scalarValue > scalarsMaxThreshold) {\n      if (scalarsReplaceMode) {\n        fragmentColor = objectColor;\n      } else {\n        fDiscardNow = 1.0;\n      }\n    } else {\n      if (scalarsReplaceMode) {\n        if (scalarsInterpolation == 1) {\n            vec3 zeroMaxColor;\n            vec3 zeroMinColor;\n            zeroMaxColor[0] = scalarsMaxColor[0]*0.33;\n            zeroMaxColor[1] = scalarsMaxColor[1]*0.33;\n            zeroMaxColor[2] = scalarsMaxColor[2]*0.33;\n            zeroMinColor[0] = scalarsMinColor[0]*0.33;\n            zeroMinColor[1] = scalarsMinColor[1]*0.33;\n            zeroMinColor[2] = scalarsMinColor[2]*0.33;\n            if(scalarValue < 0.0) {fragmentColor = scalarValue/(scalarsMin) * scalarsMinColor + (1.0 - scalarValue/(scalarsMin)) * (zeroMinColor);}\n            else {fragmentColor = scalarValue/(scalarsMax) * scalarsMaxColor + (1.0 - scalarValue/(scalarsMax)) * (zeroMaxColor);}\n        } else {\n            fragmentColor = scalarValue * scalarsMaxColor + (1.0 - scalarValue) * scalarsMinColor;\n          }\n      } else {\n        fragmentColor = vertexColor;\n      }\n    }\n  } else if (useObjectColor) {\n    fragmentColor = objectColor;\n  } else {\n    fragmentColor = vertexColor;\n  }\n  gl_PointSize = pointSize;\n  gl_Position = perspective * fVertexPosition;\n}\n";
this.qd="";this.qd="precision mediump float;\n\nuniform bool usePicking;\nuniform bool useTexture;\nuniform bool volumeTexture;\nuniform bool useLabelMapTexture;\nuniform sampler2D textureSampler;\nuniform sampler2D textureSampler2;\nuniform float objectOpacity;\nuniform float labelmapOpacity;\nuniform float volumeLowerThreshold;\nuniform float volumeUpperThreshold;\nuniform float volumeScalarMin;\nuniform float volumeScalarMax;\nuniform vec3 volumeScalarMinColor;\nuniform vec3 volumeScalarMaxColor;\nuniform float volumeWindowLow;\nuniform float volumeWindowHigh;\n\nvarying float fDiscardNow;\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fVertexNormal;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n if (fDiscardNow > 0.0) {\n   discard;\n }\n if (usePicking) {\n   gl_FragColor = vec4(fragmentColor, 1.0);\n } else if (useTexture) {\n   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n   vec4 textureSum = texture1;\n   if (volumeTexture) {\n     float _windowLow = (volumeWindowLow / volumeScalarMax);\n     float _windowHigh = (volumeWindowHigh / volumeScalarMax);\n     vec3 _minrange = vec3(_windowLow,_windowLow,_windowLow);\n     vec3 _maxrange = vec3(_windowHigh,_windowHigh,_windowHigh);\n     vec3 fac = _maxrange - _minrange;\n     textureSum = vec4((textureSum.r - _minrange)/fac,1);\n     textureSum = textureSum.r * vec4(volumeScalarMaxColor,1) + (1.0 - textureSum.r) * vec4(volumeScalarMinColor,1);\n   }\n   if (useLabelMapTexture) {\n     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n     if (texture2.a > 0.0) {\n       if (labelmapOpacity < 1.0) {\n         textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n       } else {\n         textureSum = texture2;\n       }\n     }\n   }\n   if (volumeTexture) {\n     float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n     float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n     if (texture1.r < _volumeLowerThreshold ||\n         texture1.r > _volumeUpperThreshold) {\n       discard;\n     };\n   };\n   gl_FragColor = textureSum;\n   gl_FragColor.a = objectOpacity;\n } else {\n   vec3 nNormal = normalize(fTransformedVertexNormal);\n   if (fVertexNormal == vec3(0.0,0.0,0.0)) {\n     gl_FragColor = vec4(fragmentColor,1.0);\n     return;\n   }\n   vec3 light = vec3(0.0, 0.0, 1.0);\n   vec3 lightDirection = vec3(0,0,-10);\n   lightDirection = normalize(lightDirection);\n   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n   float ambient = 0.3;\n   gl_FragColor = vec4(fragmentColor * ambient +\n                       fragmentColor * diffuse +\n                       vec3(0.2, 0.2, 0.2) * specular,\n                       objectOpacity);\n }\n}\n"}
G(Rf,K);
var Sf={Lj:"vertexPosition",Kj:"vertexNormal",Jj:"vertexColor",Nj:"vertexTexturePos",Mj:"vertexScalar"},Tf={Oj:"view",sj:"perspective",kj:"center",rj:"objectTransform",Fj:"useObjectColor",pj:"objectColor",Hj:"useScalars",Bj:"scalarsReplaceMode",yj:"scalarsMin",vj:"scalarsMax",zj:"scalarsMinColor",wj:"scalarsMaxColor",Aj:"scalarsMinThreshold",xj:"scalarsMaxThreshold",uj:"scalarsInterpolation",tj:"pointSize",qj:"objectOpacity",oj:"normal",Gj:"usePicking",Ij:"useTexture",Ej:"useLabelMapTexture",mj:"labelmapOpacity",
Cj:"textureSampler",Dj:"textureSampler2",Pj:"volumeLowerThreshold",Vj:"volumeUpperThreshold",Sj:"volumeScalarMin",Qj:"volumeScalarMax",Tj:"volumeScalarMinColor",Rj:"volumeScalarMaxColor",Xj:"volumeWindowLow",Wj:"volumeWindowHigh",Uj:"volumeTexture"};
function Uf(a){var b=Object.keys(Tf);Object.keys(Sf).every(function(a){a=Sf[a];return-1!=this.Cd.search(a)||-1!=this.qd.search(a)}.bind(a))||i(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=Tf[a];return-1!=this.Cd.search(a)||-1!=this.qd.search(a)}.bind(a))||i(Error("Could not find all uniforms in the shader sources."))};function Vf(a,b,c){y(a)||i(Error("Invalid GL Buffer."));y(b)||i(Error("Invalid number of items."));y(c)||i(Error("Invalid item size."));K.call(this);this.c="buffer";this.ja=a;this.qb=b;this.rb=c}G(Vf,K);function Wf(a,b,c,d,e,f,g,h){var j,l=c.offsetParent;if(l){var k="HTML"==l.tagName||"BODY"==l.tagName;if(!k||"static"!=lf(l,"position"))j=qf(l),k||(j=Wc(j,new Vc(l.scrollLeft,l.scrollTop)))}l=qf(a);k=tf(a);l=new hf(l.x,l.y,k.width,k.height);(k=pf(a))&&l.fg(new hf(k.left,k.top,k.right-k.left,k.bottom-k.top));var k=he(a),n=he(c);if(k.P!=n.P){var v=k.P.body,n=n.P.parentWindow||n.P.defaultView,p=new Vc(0,0),w=je(v)?je(v).parentWindow||je(v).defaultView:window,u=v;do{var z;if(w==n)z=qf(u);else{var C=u;
z=new Vc;if(1==C.nodeType)if(C.getBoundingClientRect)C=nf(C),z.x=C.left,z.y=C.top;else{var x=we(he(C)),C=qf(C);z.x=C.x-x.x;z.y=C.y-x.y}else{var x=ja(C.yh),A=C;C.targetTouches?A=C.targetTouches[0]:x&&C.Ea.targetTouches&&(A=C.Ea.targetTouches[0]);z.x=A.clientX;z.y=A.clientY}}p.x+=z.x;p.y+=z.y}while(w&&w!=n&&(u=w.frameElement)&&(w=w.parent));v=Wc(p,qf(v));Ua&&!ve(k)&&(v=Wc(v,we(k)));l.left+=v.x;l.top+=v.y}a=(b&4&&rf(a)?b^2:b)&-5;b=new Vc(a&2?l.left+l.width:l.left,a&1?l.top+l.height:l.top);j&&(b=Wc(b,
j));e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var F;if(g&&(F=pf(c))&&j)F.top-=j.y,F.right-=j.x,F.bottom-=j.y,F.left-=j.x;return Xf(b,c,d,f,F,g,h)}
function Xf(a,b,c,d,e,f,g){var a=a.f(),h=0,j=(c&4&&rf(b)?c^2:c)&-5,c=tf(b),g=g?g.f():c.f();if(d||0!=j)j&2?a.x-=g.width+(d?d.right:0):d&&(a.x+=d.left),j&1?a.y-=g.height+(d?d.bottom:0):d&&(a.y+=d.top);if(f){if(e){h=a;d=0;if(65==(f&65)&&(h.x<e.left||h.x>=e.right))f&=-2;if(132==(f&132)&&(h.y<e.top||h.y>=e.bottom))f&=-5;h.x<e.left&&f&1&&(h.x=e.left,d|=1);h.x<e.left&&h.x+g.width>e.right&&f&16&&(g.width=Math.max(g.width-(h.x+g.width-e.right),0),d|=4);h.x+g.width>e.right&&f&1&&(h.x=Math.max(e.right-g.width,
e.left),d|=1);f&2&&(d|=(h.x<e.left?16:0)|(h.x+g.width>e.right?32:0));h.y<e.top&&f&4&&(h.y=e.top,d|=2);h.y>=e.top&&h.y+g.height>e.bottom&&f&32&&(g.height=Math.max(g.height-(h.y+g.height-e.bottom),0),d|=8);h.y+g.height>e.bottom&&f&4&&(h.y=Math.max(e.bottom-g.height,e.top),d|=2);f&8&&(d|=(h.y<e.top?64:0)|(h.y+g.height>e.bottom?128:0));h=d}else h=256;if(h&496)return h}f=a;e=Va&&(Ma||$a)&&kb("1.9");f instanceof Vc?(a=f.x,f=f.y):(a=f,f=m);b.style.left=sf(a,e);b.style.top=sf(f,e);$c(c,g)||(a=ve(he(je(b))),
Ua&&(!a||!kb("8"))?(c=b.style,a?(Ua?(a=wf(b,kf(b,"paddingLeft")),e=wf(b,kf(b,"paddingRight")),f=wf(b,kf(b,"paddingTop")),d=wf(b,kf(b,"paddingBottom")),a=new gf(f,e,d,a)):(a=jf(b,"paddingLeft"),e=jf(b,"paddingRight"),f=jf(b,"paddingTop"),d=jf(b,"paddingBottom"),a=new gf(parseFloat(f),parseFloat(e),parseFloat(d),parseFloat(a))),Ua?(e=yf(b,"borderLeft"),f=yf(b,"borderRight"),d=yf(b,"borderTop"),b=yf(b,"borderBottom"),b=new gf(d,f,b,e)):(e=jf(b,"borderLeftWidth"),f=jf(b,"borderRightWidth"),d=jf(b,"borderTopWidth"),
b=jf(b,"borderBottomWidth"),b=new gf(parseFloat(d),parseFloat(f),parseFloat(b),parseFloat(e))),c.pixelWidth=g.width-b.left-a.left-a.right-b.right,c.pixelHeight=g.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=g.width,c.pixelHeight=g.height)):(b=b.style,Va?b.MozBoxSizing="border-box":Wa?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(g.width,0)+"px",b.height=Math.max(g.height,0)+"px"));return h};function Yf(){}Yf.prototype.Sa=aa();function Zf(a,b){this.element=a;this.Qf=b}G(Zf,Yf);Zf.prototype.Sa=function(a,b,c){Wf(this.element,this.Qf,a,b,m,c)};function $f(a,b){this.Qa=new zf(this);this.ff(a||q);b&&(this.zc=b)}G($f,Dc);t=$f.prototype;t.q=q;t.dh=o;t.Mf=q;t.pa=r;t.Qi=r;t.Te=-1;t.Dh=r;t.rh=o;t.zc="toggle_display";t.i=s("q");t.ff=function(a){this.pa&&i(Error("Can not change this state of the popup while showing."));this.q=a};
function ag(a,b){a.hd&&a.hd.stop();a.$c&&a.$c.stop();if(b){if(!a.pa&&a.$e()){a.q||i(Error("Caller must call setElement before trying to show the popup"));a.Sa();var c=je(a.q);a.Dh&&Bf(a.Qa,c,"keydown",a.Uh,o);if(a.dh)if(Bf(a.Qa,c,"mousedown",a.rg,o),Ua){var d;try{d=c.activeElement}catch(e){}for(;d&&"IFRAME"==d.nodeName;){try{var f=d.contentDocument||d.contentWindow.document}catch(g){break}c=f;d=c.activeElement}Bf(a.Qa,c,"mousedown",a.rg,o);Bf(a.Qa,c,"deactivate",a.qg)}else Bf(a.Qa,c,"blur",a.qg);
"toggle_display"==a.zc?(a.q.style.visibility="visible",vf(a.q,o)):"move_offscreen"==a.zc&&a.Sa();a.pa=o;a.hd?(sc(a.hd,"end",a.ug,r,a),a.hd.play()):a.ug()}}else bg(a)}t.Sa=da;function bg(a,b){if(!a.pa||!a.dispatchEvent({type:"beforehide",target:b}))return r;a.Qa&&a.Qa.Zd();a.$c?(sc(a.$c,"end",sa(a.Pf,b),r,a),a.$c.play()):a.Pf(b);return o}
t.Pf=function(a){"toggle_display"==this.zc?this.Qi?Of(this.dg,0,this):this.dg():"move_offscreen"==this.zc&&(this.q.style.left="-200px",this.q.style.top="-200px");this.pa=r;this.af(a)};t.dg=function(){this.q.style.visibility="hidden";vf(this.q,r)};t.$e=function(){return this.dispatchEvent("beforeshow")};t.ug=function(){this.Te=ta();this.dispatchEvent("show")};t.af=function(a){ta();this.dispatchEvent({type:"hide",target:a})};
t.rg=function(a){a=a.target;!ue(this.q,a)&&(!this.Mf||ue(this.Mf,a))&&!(150>ta()-this.Te)&&bg(this,a)};t.Uh=function(a){27==a.keyCode&&bg(this,a.target)&&(a.preventDefault(),a.stopPropagation())};t.qg=function(a){if(this.rh){var b=je(this.q);if(Ua||Sa){if(a=b.activeElement,!a||ue(this.q,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>ta()-this.Te||bg(this)}};t.O=function(){$f.j.O.call(this);this.Qa.Oa();Xb(this.hd);Xb(this.$c);delete this.q;delete this.Qa};function cg(a,b){this.He=a instanceof Vc?a:new Vc(a,b)}G(cg,Yf);cg.prototype.Sa=function(a,b,c,d){Wf(mf(a),0,a,b,this.He,c,q,d)};function dg(a,b){this.vi=4;this.Yd=b||m;$f.call(this,a)}G(dg,$f);dg.prototype.Sa=function(){if(this.Yd){var a=!this.pa&&"move_offscreen"!=this.zc,b=this.i();a&&(b.style.visibility="hidden",vf(b,o));this.Yd.Sa(b,this.vi,this.$j);a&&vf(b,r)}};function eg(a,b,c){this.Ya=c||(a?he(ke(a)):he());dg.call(this,this.Ya.oc("div",{style:"position:absolute;display:none;"}));this.Je=new Vc(1,1);this.$b=new Sb;a&&fg(this,a);if(b!=q)if(a=this.i(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild(je(a).createTextNode(b))}}G(eg,dg);var gg=[];t=eg.prototype;t.oa=q;t.className="goog-tooltip";
t.Cg=500;t.Ch=0;t.Nd=s("Ya");function fg(a,b){b=ke(b);a.$b.add(b);J(b,"mouseover",a.ag,r,a);J(b,"mouseout",a.Sd,r,a);J(b,"mousemove",a.$f,r,a);J(b,"focus",a.Zf,r,a);J(b,"blur",a.Sd,r,a)}t.detach=function(a){if(a)a=ke(a),hg(this,a),this.$b.remove(a);else{for(var b=this.$b.Pa(),c=0;a=b[c];c++)hg(this,a);this.$b.clear()}};function hg(a,b){tc(b,"mouseover",a.ag,r,a);tc(b,"mouseout",a.Sd,r,a);tc(b,"mousemove",a.$f,r,a);tc(b,"focus",a.Zf,r,a);tc(b,"blur",a.Sd,r,a)}
t.ff=function(a){var b=this.i();b&&se(b);eg.j.ff.call(this,a);a&&(b=this.Ya.P.body,b.insertBefore(a,b.lastChild))};t.$e=function(){if(!$f.prototype.$e.call(this))return r;if(this.anchor)for(var a,b=0;a=gg[b];b++)ue(a.i(),this.anchor)||ag(a,r);0<=vb(gg,this)||gg.push(this);a=this.i();a.className=this.className;ig(this);J(a,"mouseover",this.cg,r,this);J(a,"mouseout",this.bg,r,this);jg(this);return o};
t.af=function(){Ab(gg,this);for(var a=this.i(),b,c=0;b=gg[c];c++)b.anchor&&ue(a,b.anchor)&&ag(b,r);this.yg&&kg(this.yg);tc(a,"mouseover",this.cg,r,this);tc(a,"mouseout",this.bg,r,this);this.anchor=m;if(0==(this.jb?this.pa?4:1:this.sc?3:this.pa?2:0))this.$d=r;$f.prototype.af.call(this)};t.og=function(a,b){this.anchor==a&&this.$b.contains(this.anchor)&&(this.$d||!this.ak?(ag(this,r),this.pa||(this.anchor=a,this.Yd=b||lg(this,0)||m,this.pa&&this.Sa(),ag(this,o))):this.anchor=m);this.jb=m};
t.Qh=function(a){this.sc=m;a==this.anchor&&(this.oa==q||this.oa!=this.i()&&!this.$b.contains(this.oa))&&(!this.Nf||!this.Nf.oa)&&ag(this,r)};function mg(a,b){var c=we(a.Ya);a.Je.x=b.clientX+c.x;a.Je.y=b.clientY+c.y}t.ag=function(a){var b=ng(this,a.target);this.oa=b;ig(this);b!=this.anchor&&(this.anchor=b,this.jb||(this.jb=Of(ra(this.og,this,b,m),this.Cg)),og(this),mg(this,a))};function ng(a,b){try{for(;b&&!a.$b.contains(b);)b=b.parentNode;return b}catch(c){return q}}
t.$f=function(a){mg(this,a);this.$d=o};t.Zf=function(a){this.oa=a=ng(this,a.target);this.$d=o;if(this.anchor!=a){this.anchor=a;var b=lg(this,1);ig(this);this.jb||(this.jb=Of(ra(this.og,this,a,b),this.Cg));og(this)}};function lg(a,b){if(0==b){var c=a.Je.f();return new pg(c)}return new qg(a.oa)}function og(a){if(a.anchor)for(var b,c=0;b=gg[c];c++)ue(b.i(),a.anchor)&&(b.Nf=a,a.yg=b)}
t.Sd=function(a){var b=ng(this,a.target),c=ng(this,a.relatedTarget);b!=c&&(b==this.oa&&(this.oa=q),jg(this),this.$d=r,this.pa&&(!a.relatedTarget||!ue(this.i(),a.relatedTarget))?kg(this):this.anchor=m)};t.cg=function(){var a=this.i();this.oa!=a&&(ig(this),this.oa=a)};t.bg=function(a){var b=this.i();if(this.oa==b&&(!a.relatedTarget||!ue(b,a.relatedTarget)))this.oa=q,kg(this)};function jg(a){a.jb&&(Nf.clearTimeout(a.jb),a.jb=m)}
function kg(a){if(2==(a.jb?a.pa?4:1:a.sc?3:a.pa?2:0))a.sc=Of(ra(a.Qh,a,a.anchor),a.Ch)}function ig(a){a.sc&&(Nf.clearTimeout(a.sc),a.sc=m)}t.O=function(){ag(this,r);jg(this);this.detach();this.i()&&se(this.i());this.oa=q;delete this.Ya;eg.j.O.call(this)};function pg(a,b){cg.call(this,a,b)}G(pg,cg);pg.prototype.Sa=function(a,b,c){b=mf(a);b=pf(b);c=c?new gf(c.top+10,c.right,c.bottom,c.left+10):new gf(10,0,0,10);Xf(this.He,a,4,c,b,9)&496&&Xf(this.He,a,4,c,b,5)};function qg(a){Zf.call(this,a,3)}
G(qg,Zf);qg.prototype.Sa=function(a,b,c){var d=new Vc(10,0);Wf(this.element,this.Qf,a,b,d,c,9)&496&&Wf(this.element,2,a,1,d,c,5)};function rg(a,b,c,d){y(a)||i(Error("No valid parent element."));(!D(b)||!D(c))&&i(Error("Invalid coordinates."));(!y(d)||!(d instanceof W))&&i(Error("Invalid interactor."));eg.call(this);this.c="caption";this.ma=a;this.Ed=b;this.Fd=c;this.Mb=d;this.hb=q;this.Ib=[];this.Ib=[".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n  border: 1px solid infotext;\n  padding: 1px;\n  font-family: sans-serif;\n}"];sc(d,Jd,this.Td.bind(this));this.Qe()}G(rg,eg);
rg.prototype.Qe=function(){if("static"==this.ma.style.position||""==this.ma.style.position)this.ma.style.position="relative";var a=document.getElementsByTagName("head")[0],b=ne("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.Ib[0]);a.appendChild(b);b.appendChild(c);this.hb=b;this.Yd=new cg(this.Ed,this.Fd)||m;this.pa&&this.Sa();ag(this,o);fg(this,this.ma);this.i().classList.add("x-tooltip")};
rg.prototype.Td=function(){ag(this,r);this.hb&&se(this.hb);this.i()&&se(this.i());this.hb=q};function sg(){Pf.call(this);this.c="renderer3D";this.Jc=this.Mc=this.Ic=this.Lc=this.Hc=this.Kc=this.ue=this.ve=q;this.l=[0,0,0];this.Hf=q;this.ee=new Ob;this.Pc=new Ob;this.Sc=new Ob;this.qe=new Ob;this.od=new Ob;this.yd=new Ob;this.zd=new Ob;this.Ad=new Ob;this.J={PROGRESSBAR_ENABLED:o,PICKING_ENABLED:o,ORDERING_ENABLED:o,STATISTICS_ENABLED:r}}G(sg,Pf);sg.prototype.__defineGetter__("config",s("J"));t=sg.prototype;t.Ei=function(){this.Jc=this.Mc=this.Ic=this.Lc=this.Hc=this.Kc=q;this.l=[0,0,0]};
t.bf=function(a){sg.j.bf.call(this,a);var b=a.Ed,a=a.Fd,c=this.get(this.zg(b,a));if(c&&(c=c.hc))(new rg(this.s,this.s.offsetLeft+b+10,this.s.offsetTop+a+10,this.Mb)).i().innerHTML=c};
t.ha=function(){sg.j.ha.call(this,"experimental-webgl");try{if(this.a.viewport(0,0,this.M,this.G),this.a.clearColor(0,0,0,0),this.a.enable(this.a.BLEND),this.a.blendEquation(this.a.FUNC_ADD),this.a.blendFunc(this.a.SRC_ALPHA,this.a.ONE_MINUS_SRC_ALPHA),this.a.enable(this.a.DEPTH_TEST),this.a.depthFunc(this.a.LEQUAL),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),this.J.PICKING_ENABLED){var a=this.a.createFramebuffer(),b=this.a.createRenderbuffer(),c=this.a.createTexture();this.a.bindTexture(this.a.TEXTURE_2D,
c);this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,this.M,this.G,0,this.a.RGB,this.a.UNSIGNED_BYTE,q);this.a.bindFramebuffer(this.a.FRAMEBUFFER,a);this.a.bindRenderbuffer(this.a.RENDERBUFFER,b);this.a.renderbufferStorage(this.a.RENDERBUFFER,this.a.DEPTH_COMPONENT16,this.M,this.G);this.a.bindRenderbuffer(this.a.RENDERBUFFER,q);this.a.framebufferTexture2D(this.a.FRAMEBUFFER,this.a.COLOR_ATTACHMENT0,this.a.TEXTURE_2D,c,0);this.a.framebufferRenderbuffer(this.a.FRAMEBUFFER,this.a.DEPTH_ATTACHMENT,this.a.RENDERBUFFER,
b);this.a.bindFramebuffer(this.a.FRAMEBUFFER,q);this.Hf=a}}catch(d){i(Error("Exception while accessing GL Context!\n"+d))}tg(this)};
function tg(a){var b=new Rf;(!y(a.ia)||!y(a.a)||!y(a.r))&&i(Error("Renderer was not initialized properly."));(!y(b)||!(b instanceof Rf))&&i(Error("Could not add shaders."));Uf(b);var c=a.a.createShader(a.a.FRAGMENT_SHADER),d=a.a.createShader(a.a.VERTEX_SHADER);a.a.shaderSource(c,b.qd);a.a.shaderSource(d,b.Cd);a.a.compileShader(c);a.a.compileShader(d);a.a.getShaderParameter(c,a.a.COMPILE_STATUS)||i(Error("Fragement Shader compilation failed!\n"+a.a.getShaderInfoLog(c)));a.a.getShaderParameter(d,a.a.COMPILE_STATUS)||
i(Error("Vertex Shader compilation failed!\n"+a.a.getShaderInfoLog(d)));var e=a.a.createProgram();a.a.attachShader(e,d);a.a.attachShader(e,c);a.a.linkProgram(e);a.a.getProgramParameter(e,a.a.LINK_STATUS)||i(Error("Could not create shader program!\n"+a.a.getShaderInfoLog(c)+"\n"+a.a.getShaderInfoLog(d)+"\n"+a.a.getProgramInfoLog(e)));a.a.useProgram(e);a.ue=e;Object.keys(Sf).forEach(function(a){a=Sf[a];this.ee.set(a,this.a.getAttribLocation(this.ue,a));this.a.enableVertexAttribArray(this.ee.get(a))}.bind(a));
Object.keys(Tf).forEach(function(a){a=Tf[a];this.Pc.set(a,this.a.getUniformLocation(this.ue,a))}.bind(a));a.ve=b}
t.bb=function(a){sg.j.bb.call(this,a);var b=r;this.get(a.ra)&&(b=o);var c=a.ra,d=a.g,e=a.h,f=a.Y,g=a.w,h=a.p,j=a.Yb,l=a.aa,k=a.n,n=a.t;if(y(k)&&y(k.p)&&k.p.e)this.bb(k);else if(y(k)&&k.e&&this.bb(k),y(l)&&y(l.p)&&l.p.e)this.B.load(l,a);else if(y(g)&&y(g.p)&&g.p.e)this.B.load(g,a);else{if(y(h)&&B(h))if(y(a.fc)){if(a.fc.Ud!=h.length||!a.e)return}else{b=0;c=h.length;for(b=0;b<c;b++)this.B.load(h[b],a);return}else{if(y(h)&&h.e){this.B.load(a,a);return}if(y(n)&&y(n.p)&&n.p.e){this.B.load(n,a);return}}if(0<
a.d.length){h=a.d;l=h.length;for(k=k=0;k<l;k++)this.bb(h[k])}if(d){for(h=0;this.ud;)h++,window.console.log("Possible thread lock avoided: "+h);this.ud=o;l=a instanceof Be&&a.ib instanceof De;b&&y(g)&&g.e&&(h=this.zd.get(c),y(h)&&this.a.isBuffer(h.ja)&&this.a.deleteBuffer(h.ja));h=q;y(g)&&(!b||g.e?(h=a.Xb,y(h)||i(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),k=r,g.ua&&(k=o),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,k),k=this.a.createTexture(),
k.Fh=g.mb,this.Ad.set(g.ra,k),this.a.bindTexture(this.a.TEXTURE_2D,k),g.ua?this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,g.Ab,g.zb,0,this.a.RGBA,this.a.UNSIGNED_BYTE,g.ua):this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,this.a.RGBA,this.a.UNSIGNED_BYTE,k.Fh),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE),l?(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST),
this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST)):(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.LINEAR),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.LINEAR)),this.a.bindTexture(this.a.TEXTURE_2D,q),k=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,k),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(h),this.a.STATIC_DRAW),h=new Vf(k,h.length,2),g.e=r):h=this.zd.get(c));Se(this.B,0.1);if(l)this.ud=
r,H.Ca(this.c+".update"),Se(this.B,0.9);else{if(!b||d.e||j.e){l=j.C;g=l.Ra(new M(d.Qb,d.Rb,d.Sb));l=l.Ra(new M(d.Nb,d.Ob,d.Pb));if(this.Kc===q||g.x<this.Kc)this.Kc=g.x;if(this.Hc===q||l.x>this.Hc)this.Hc=l.x;if(this.Lc===q||g.y<this.Lc)this.Lc=g.y;if(this.Ic===q||l.y>this.Ic)this.Ic=l.y;if(this.Mc===q||g.b<this.Mc)this.Mc=g.b;if(this.Jc===q||l.b>this.Jc)this.Jc=l.b;this.l=[(this.Kc+this.Hc)/2,(this.Lc+this.Ic)/2,(this.Mc+this.Jc)/2];j.e=r}b&&d.e&&(j=this.Sc.get(c),y(j)&&this.a.isBuffer(j.ja)&&this.a.deleteBuffer(j.ja));
j=q;!b||d.e?(j=this.a.createBuffer(),d.yc(),this.a.bindBuffer(this.a.ARRAY_BUFFER,j),this.a.bufferData(this.a.ARRAY_BUFFER,d.L,this.a.STATIC_DRAW),j=new Vf(j,d.count,3),d.e=r):j=this.Sc.get(c);Se(this.B,0.3);b&&e.e&&(g=this.Sc.get(c),y(g)&&this.a.isBuffer(g.ja)&&this.a.deleteBuffer(g.ja));g=q;!b||e.e?(g=this.a.createBuffer(),e.yc(),this.a.bindBuffer(this.a.ARRAY_BUFFER,g),this.a.bufferData(this.a.ARRAY_BUFFER,e.L,this.a.STATIC_DRAW),g=new Vf(g,e.count,3),e.e=r):g=this.qe.get(c);Se(this.B,0.3);b&&
f&&f.e&&(e=this.od.get(c),y(e)&&this.a.isBuffer(e.ja)&&this.a.deleteBuffer(e.ja));e=q;f&&(!b||f.e?(f.length!=d.length&&i(Error("Mismatch between points and point colors.")),e=this.a.createBuffer(),f.yc(),this.a.bindBuffer(this.a.ARRAY_BUFFER,e),this.a.bufferData(this.a.ARRAY_BUFFER,f.L,this.a.STATIC_DRAW),e=new Vf(e,f.count,3),f.e=r):e=this.od.get(c));Se(this.B,0.2);b&&n&&n.e&&(f=this.yd.get(c),y(f)&&this.a.isBuffer(f.ja)&&this.a.deleteBuffer(f.ja));f=q;n&&(f=n.Bc,!b||n.e?(f.length!=d.length&&i(Error("Mismatch between points and scalars.")),
d=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,d),this.a.bufferData(this.a.ARRAY_BUFFER,f,this.a.STATIC_DRAW),f=new Vf(d,f.length,3),n.e=r):f=this.yd.get(c));Se(this.B,0.1);b||this.fb.add(a);this.Sc.set(c,j);this.qe.set(c,g);this.od.set(c,e);this.zd.set(c,h);this.yd.set(c,f);this.ud=a.e=r}}else a.e=r}};function vg(a,b){var c=b.g.nd,c=a.r.m.Ra(b.Yb.C.Ra(new M(c[0],c[1],c[2]))),c=Sc(a.r.ta,c);return Math.round(1E3*c)/1E3}
t.zg=function(a,b){if(this.J.PICKING_ENABLED){this.Eb(o,r);var c=new Uint8Array(4);this.a.readPixels(a,this.G-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);return c[0]+255*c[1]+65025*c[2]}return-1};
t.Eb=function(a,b){sg.j.Eb.call(this,a,b);var c=this.fb.u,d=c.length;if(0!=d){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.Hf):this.a.bindFramebuffer(this.a.FRAMEBUFFER,q);this.a.viewport(0,0,this.M,this.G);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var e=this.r.Gf,f=this.r.Lb;this.a.uniformMatrix4fv(this.Pc.get("perspective"),r,e);this.a.uniformMatrix4fv(this.Pc.get("view"),r,f);e=this.l;this.a.uniform3f(this.Pc.get("center"),parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]));
f=this.Xa.length;for(e=0;e<f;++e){var g=this.Xa[e];if(g instanceof L){var h=new M(1,0,0),h=this.r.m.Ra(h),j=Sc(this.r.ta,h),h=new M(-1,0,0),h=this.r.m.Ra(h),l=Sc(this.r.ta,h),h=new M(0,1,0),h=this.r.m.Ra(h),k=Sc(this.r.ta,h),h=new M(0,-1,0),h=this.r.m.Ra(h),n=Sc(this.r.ta,h),h=new M(0,0,1),h=this.r.m.Ra(h),v=Sc(this.r.ta,h),h=new M(0,0,-1),h=this.r.m.Ra(h),h=Sc(this.r.ta,h),p=Math.max(j,k,v,l,n,h);p==j||p==l?Ce(g,0):p==k||p==n?Ce(g,1):(p==v||p==h)&&Ce(g,2)}}if(this.J.ORDERING_ENABLED){j=r;f=this.Xa;
g=f.length-1;do if(e=f[g],e instanceof L&&e.Ma){l=e.Cb;j=e.R.d;1==l?j=e.S.d:2==l&&(j=e.gb.d);l=j.length;k=j[0];k.K=vg(this,k);k.Z=e.Z;n=j[l-1];n.K=vg(this,n);n.Z=e.Z;n=Math.round(1E3*((n.K-k.K)/l))/1E3;for(v=v=1;v<l-1;v++)h=Math.round(1E3*(k.K+v*n))/1E3,j[v].K=h,j[v].Z=e.Z;j=o}while(g--);f=this.fb.u;g=f.length-1;do if(e=f[g],e.La&&!(1==e.Z||e instanceof Be))e.K=vg(this,e),j=o;while(g--);j&&this.fb.sort()}if(f=!a&&y(b)&&b&&this.J.STATISTICS_ENABLED)var w=0,u=0,z=0,C=0;var e=this.ee,g=e.get("vertexPosition"),
j=e.get("vertexNormal"),l=e.get("vertexColor"),k=e.get("vertexTexturePos"),n=e.get("vertexScalar"),e=this.Pc,v=e.get("usePicking"),h=e.get("useObjectColor"),p=e.get("objectColor"),x=e.get("useScalars"),A=e.get("scalarsReplaceMode"),F=e.get("scalarsMin"),I=e.get("scalarsMax"),S=e.get("scalarsMinColor"),O=e.get("scalarsMaxColor"),P=e.get("scalarsInterpolation"),ea=e.get("scalarsMinThreshold"),Q=e.get("scalarsMaxThreshold"),Z=e.get("objectOpacity"),qa=e.get("labelmapOpacity"),Ka=e.get("useTexture"),
T=e.get("useLabelMapTexture"),Fc=e.get("textureSampler"),nd=e.get("textureSampler2"),tb=e.get("volumeLowerThreshold"),od=e.get("volumeUpperThreshold"),Lb=e.get("volumeScalarMin"),ib=e.get("volumeScalarMax"),Jb=e.get("volumeWindowLow"),Hc=e.get("volumeWindowHigh"),Da=e.get("volumeScalarMinColor"),sb=e.get("volumeScalarMaxColor"),Gc=e.get("volumeTexture"),md=e.get("objectTransform"),ug=e.get("pointSize"),e=d;do{var U=c[d-e];if(U){var Y=q;U instanceof Be&&U.ib&&(Y=U.ib);if(U.La&&(!Y||Y.La)){var wa=U.ra,
Ta=U.Gc,Ea=this.Sc.get(wa),bb=this.qe.get(wa),Zd=this.od.get(wa),Kb=this.yd.get(wa),pe=this.zd.get(wa);this.a.bindBuffer(this.a.ARRAY_BUFFER,Ea.ja);this.a.vertexAttribPointer(g,Ea.rb,this.a.FLOAT,r,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,bb.ja);this.a.vertexAttribPointer(j,bb.rb,this.a.FLOAT,r,0,0);a?this.a.uniform1i(v,o):this.a.uniform1i(v,r);Zd&&!a&&!Ta?(this.a.uniform1i(h,r),this.a.bindBuffer(this.a.ARRAY_BUFFER,Zd.ja),this.a.vertexAttribPointer(l,Zd.rb,this.a.FLOAT,r,0,0)):(bb=1,Ta&&!a&&(bb=
0),this.a.uniform1i(h,bb),bb=U.Hb,a&&(bb=[Math.floor(wa%65025%255)/255,Math.floor(wa%65025/255)/255,Math.floor(wa/65025)/255]),this.a.uniform3f(p,parseFloat(bb[0]),parseFloat(bb[1]),parseFloat(bb[2])),this.a.vertexAttribPointer(l,Ea.rb,this.a.FLOAT,r,0,0));Kb&&!a&&!Ta?(this.a.uniform1i(x,o),this.a.uniform1i(A,U.t.Jf),wa=U.t.vb,Ta=U.t.tb,this.a.uniform3f(S,parseFloat(wa[0]),parseFloat(wa[1]),parseFloat(wa[2])),this.a.uniform3f(O,parseFloat(Ta[0]),parseFloat(Ta[1]),parseFloat(Ta[2])),this.a.uniform1f(ea,
parseFloat(U.t.Q)),this.a.uniform1f(Q,parseFloat(U.t.T)),this.a.uniform1f(F,parseFloat(U.t.Ka)),this.a.uniform1f(I,parseFloat(U.t.Da)),this.a.uniform1i(P,parseInt(U.t.he,10)),this.a.bindBuffer(this.a.ARRAY_BUFFER,Kb.ja),this.a.vertexAttribPointer(n,Kb.rb,this.a.FLOAT,r,0,0)):(this.a.uniform1i(x,r),this.a.vertexAttribPointer(n,Ea.rb,this.a.FLOAT,r,0,0));this.a.uniform1f(Z,parseFloat(U.Z));U.w&&pe&&!a?(this.a.uniform1i(Ka,o),this.a.activeTexture(this.a.TEXTURE0),this.a.bindTexture(this.a.TEXTURE_2D,
this.Ad.get(U.w.ra)),this.a.uniform1i(Fc,0),this.a.bindBuffer(this.a.ARRAY_BUFFER,pe.ja),this.a.vertexAttribPointer(k,pe.rb,this.a.FLOAT,r,0,0),this.a.uniform1i(Gc,r)):(this.a.uniform1i(Ka,r),this.a.vertexAttribPointer(k,Ea.rb,this.a.FLOAT,r,0,0));Y&&(this.a.uniform1i(Gc,o),this.a.uniform1f(tb,Y.Q),this.a.uniform1f(od,Y.T),this.a.uniform1f(Lb,Y.Ka),this.a.uniform1f(ib,Y.Da),wa=Y.vb,Ta=Y.tb,this.a.uniform3f(Da,parseFloat(wa[0]),parseFloat(wa[1]),parseFloat(wa[2])),this.a.uniform3f(sb,parseFloat(Ta[0]),
parseFloat(Ta[1]),parseFloat(Ta[2])),this.a.uniform1f(Jb,Y.V),this.a.uniform1f(Hc,Y.U),Kb=Y.n,this.a.uniform1i(T,r),Y.Ma?this.a.uniform1f(Z,parseFloat(Y.Z)):Kb&&Kb.La&&(Y=U.n.ra,this.a.uniform1i(T,o),this.a.activeTexture(this.a.TEXTURE1),this.a.bindTexture(this.a.TEXTURE_2D,this.Ad.get(Y)),this.a.uniform1i(nd,1),this.a.uniform1f(qa,Kb.Z)));this.a.uniformMatrix4fv(md,r,U.Yb.yf);Y=1;"POINTS"==U.ka&&(Y=U.Nc);this.a.uniform1f(ug,Y);Y=-1;U.ka==rd?(Y=this.a.TRIANGLES,f&&(u+=Ea.qb/3)):"LINES"==U.ka?(this.a.lineWidth(U.lc),
Y=this.a.LINES,f&&(z+=Ea.qb/2)):"POINTS"==U.ka?(Y=this.a.POINTS,f&&(C+=Ea.qb)):"TRIANGLE_STRIPS"==U.ka?(Y=this.a.TRIANGLE_STRIP,f&&(u+=Ea.qb/3)):"POLYGONS"==U.ka&&(Y=0==Ea.qb%3?this.a.TRIANGLES:this.a.TRIANGLE_FAN,f&&(u+=Ea.qb/3));f&&(w+=Ea.qb);this.a.drawArrays(Y,0,Ea.qb)}}}while(--e);f&&(c="Objects: "+d+" | "+("Vertices: "+w+" | ")+("Triangles: "+Math.round(u)+" | "),c=c+("Lines: "+z+" | ")+("Points: "+C+" | ")+("Textures: "+this.Ad.Za()),window.console.log(c))}};
t.Ld=function(){this.ve=q;delete this.ve;this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);sg.j.Ld.call(this)};E("X.renderer3D",sg);E("X.renderer3D.prototype.init",sg.prototype.ha);E("X.renderer3D.prototype.add",sg.prototype.add);E("X.renderer3D.prototype.onShowtime",sg.prototype.vg);E("X.renderer3D.prototype.onRender",sg.prototype.tg);E("X.renderer3D.prototype.get",sg.prototype.get);E("X.renderer3D.prototype.render",sg.prototype.ec);E("X.renderer3D.prototype.destroy",sg.prototype.Ld);
E("X.renderer3D.prototype.resetBoundingBox",sg.prototype.Ei);E("X.renderer3D.prototype.resetViewAndRender",sg.prototype.xc);E("X.renderer3D.prototype.pick",sg.prototype.zg);function wg(){Pf.call(this);this.c="renderer2D";this.zf=this.ie=this.xf=this.ge=this.wb=q;this.xd=this.Ub=this.Vb=this.we=this.xe=0;this.U=this.V=this.T=this.Q=this.vf=-1}G(wg,Pf);wg.prototype.ii=aa();wg.prototype.ri=aa();wg.prototype.cf=function(a){wg.j.cf.call(this,a);var b=this.Xa[0];if(b){var c=this.wb;b["index"+c]=a.I?b["index"+c]+1:b["index"+c]-1;eval("this.onScroll();")}};
wg.prototype.si=function(a){var b=this.Xa[0];if(b){var c=b.U-b.V,d=c/2,e=parseInt(c+c/15*-a.Ae,10),a=parseInt(d+d/15*a.ne,10);c==e&&e++;d==a&&a++;b.V-=parseInt(d-a,10);b.V-=parseInt(c-e,10);b.V=Math.max(b.V,b.Ka);b.U-=parseInt(d-a,10);b.U+=parseInt(c-e,10);b.U=Math.min(b.U,b.Da);eval("this.onWindowLevel();")}};wg.prototype.__defineGetter__("orientation",s("wb"));
wg.prototype.__defineSetter__("orientation",function(a){a=a.toUpperCase();"X"!=a&&"Y"!=a&&"Z"!=a&&i(Error("Invalid orientation."));this.wb=a});t=wg.prototype;t.ha=function(){this.wb||i(Error("No 2D orientation set."));wg.j.ha.call(this,"2d");this.a.fillStyle="rgba(0,0,0,0)";this.a.fillRect(0,0,this.ia.width,this.ia.height);this.ge=ne("canvas");this.ie=ne("canvas");J(this.r,Fd,this.si.bind(this))};t.rotate=function(){this.xd++};t.Fi=function(){this.xd--};
t.xc=function(){wg.j.xc.call(this);xg(this);var a=this.Xa[0];a&&(a.U=a.Da,a.V=a.Ka)};
t.bb=function(a){wg.j.bb.call(this,a);var b=r;this.get(a.ra)&&(b=o);if(a instanceof L){var c=a.p,d=a.n,e=a.aa;if(y(d)&&y(d.p)&&d.p.e)this.bb(d);else if(y(e)&&y(e.p)&&e.p.e)this.B.load(e,a);else{if(y(c)&&B(c))if(y(a.fc)){if(a.fc.Ud!=c.length||b&&!a.e)return}else{b=0;d=c.length;for(b=0;b<d;b++)this.B.load(c[b],a);return}else if(y(c)&&c.e){this.B.load(a,a);return}var d=c=0,e=a.ca,f=a.H;"X"==this.wb?(this.Wb=a.R.d,c=e[1],d=e[2],this.Vb=f[1],this.Ub=f[2]):"Y"==this.wb?(this.Wb=a.S.d,c=e[0],d=e[2],this.Vb=
f[0],this.Ub=f[2]):"Z"==this.wb&&(this.Wb=a.gb.d,c=e[0],d=e[1],this.Vb=f[0],this.Ub=f[1]);this.xe=c;this.we=d;e=this.ge;e.width=c;e.height=d;f=this.ie;f.width=c;f.height=d;this.xf=e.getContext("2d");this.zf=f.getContext("2d");b||(this.fb.add(a),xg(this))}}};function xg(a){a.r.m.k(2,3,Math.min(a.M/(a.xe*a.Vb),a.G/(a.we*a.Ub)))}
t.Eb=function(a,b){wg.j.Eb.call(this,a,b);if(0!=this.fb.u.length){var c=this.M,d=this.G,e=this.r.m;this.a.save();this.a.clearRect(-c,-d,2*c,2*d);this.a.restore();var f=1*e.X(0,3),g=-1*e.X(1,3),h=Math.max(e.X(2,3),0.6);this.a.setTransform(h,0,0,h,f,g);var e=this.Xa[0],j=e["index"+this.wb],l=this.Wb[parseInt(j,10)],k=l.w.ua,l=l.n,n=q;l&&(n=l.ua);var v=this.xe,p=this.we,w=this.xf,u=this.zf,z=w.getImageData(0,0,v,p),C=u.getImageData(0,0,v,p),x=z.data,A=C.data,F=x.length,I=e.Da,S=e.Q,O=e.T,P=e.V/I,ea=
e.U/I;if(this.vf!=j||this.Q!=S||this.T!=O||this.V!=P||this.U!=ea){var Q=0;do{var Z=[0,0,0,0],qa=[0,0,0,0],Ka=k[Q]/255*I,T=k[Q],T=(T/255-P)/(ea-P),T=255*T;Ka>=S&&Ka<=O&&(Z=new M(e.vb[0],e.vb[1],e.vb[2]),Z=(new M(e.tb[0],e.tb[1],e.tb[2])).scale(T).add(Z.scale(255-T)),Z=[Math.floor(Z.x),Math.floor(Z.y),Math.floor(Z.b),255],l&&(qa=[n[Q],n[Q+1],n[Q+2],n[Q+3]]));T=F-1-Q;x[T-3]=Z[0];x[T-2]=Z[1];x[T-1]=Z[2];x[T]=Z[3];A[T-3]=qa[0];A[T-2]=qa[1];A[T-1]=qa[2];A[T]=qa[3];Q+=4}while(Q<F);w.putImageData(z,0,0);
u.putImageData(C,0,0);this.vf=j;this.Q=S;this.T=O;this.V=P;this.U=ea}this.a.globalAlpha=1;this.a.translate(c/2/h,d/2/h);this.a.rotate(0.5*Math.PI*this.xd);switch(this.xd%4){case 1:c=f;f=g;g=-c;break;case 2:f*=-1;g*=-1;break;case 3:c=f,f=-g,g=c}f=-v*this.Vb/2+f;g=-p*this.Ub/2+g;this.a.drawImage(this.ge,f,g,v*this.Vb,p*this.Ub);l&&e.n.La&&(this.a.globalAlpha=e.n.Z,this.a.drawImage(this.ie,f,g,v*this.Vb,p*this.Ub))}};E("X.renderer2D",wg);E("X.renderer2D.prototype.init",wg.prototype.ha);
E("X.renderer2D.prototype.add",wg.prototype.add);E("X.renderer2D.prototype.onShowtime",wg.prototype.vg);E("X.renderer2D.prototype.onRender",wg.prototype.tg);E("X.renderer2D.prototype.onScroll",wg.prototype.ii);E("X.renderer2D.prototype.onWindowLevel",wg.prototype.ri);E("X.renderer2D.prototype.get",wg.prototype.get);E("X.renderer2D.prototype.rotate",wg.prototype.rotate);E("X.renderer2D.prototype.rotateCounter",wg.prototype.Fi);E("X.renderer2D.prototype.resetViewAndRender",wg.prototype.xc);
E("X.renderer2D.prototype.render",wg.prototype.ec);E("X.renderer2D.prototype.destroy",wg.prototype.Ld);function yg(){R.call(this);this.c="fibers";va(this,new Pc)}G(yg,R);E("X.fibers",yg);function zg(){R.call(this);this.c="mesh";va(this,new Pc)}G(zg,R);E("X.mesh",zg);
